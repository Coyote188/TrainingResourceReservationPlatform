STK.register("kit.dom.parseDOM",function(a){return function(a){for(var b in a)a[b]&&a[b].length==1&&(a[b]=a[b][0]);return a}});
STK.register("core.obj.parseParam",function(a){return function(a,b,c){var d,e={};b=b||{};for(d in a){e[d]=a[d];b[d]!=null&&(c?a.hasOwnProperty[d]&&(e[d]=b[d]):e[d]=b[d])}return e}});
STK.register("core.dom.isNode",function(a){return function(a){return a!=undefined&&Boolean(a.nodeName)&&Boolean(a.nodeType)}});
STK.register("core.arr.isArray",function(a){return function(a){return Object.prototype.toString.call(a)==="[object Array]"}});
STK.register("core.evt.custEvent",function(a){var b="__custEventKey__",c=1,d={},e=function(a,c){var e=typeof a=="number"?a:a[b];return e&&d[e]&&{obj:typeof c=="string"?d[e][c]:d[e],key:e}};return{define:function(a,e){if(a&&e){var f=typeof a=="number"?a:a[b]||(a[b]=c++),g=d[f]||(d[f]={});e=[].concat(e);for(var h=0;h<e.length;h++)g[e[h]]||(g[e[h]]=[]);return f}},undefine:function(a,c){if(a){var e=typeof a=="number"?a:a[b];if(e&&d[e])if(c){c=[].concat(c);for(var f=0;f<c.length;f++)c[f]in d[e]&&delete d[e][c[f]]}else delete d[e]}},add:function(a,b,c,d){if(a&&typeof b=="string"&&c){var f=e(a,b);if(!f||!f.obj)throw"custEvent ("+b+") is undefined !";f.obj.push({fn:c,data:d});return f.key}},once:function(a,b,c,d){if(a&&typeof b=="string"&&c){var f=e(a,b);if(!f||!f.obj)throw"custEvent ("+b+") is undefined !";f.obj.push({fn:c,data:d,once:!0});return f.key}},remove:function(b,c,d){if(b){var f=e(b,c),g,h;if(f&&(g=f.obj)){if(a.core.arr.isArray(g))if(d){var i=0;while(g[i]){if(g[i].fn===d)break;i++}g.splice(i,1)}else g.splice(0,g.length);else for(var i in g)g[i]=[];return f.key}}},fire:function(b,c,d){if(b&&typeof c=="string"){var f=e(b,c),g;if(f&&(g=f.obj)){a.core.arr.isArray(d)||(d=d!=undefined?[d]:[]);for(var h=g.length-1;h>-1&&g[h];h--){var i=g[h].fn,j=g[h].once;if(i&&i.apply)try{i.apply(b,[{type:c,data:g[h].data}].concat(d));j&&g.splice(h,1)}catch(k){a.log("[error][custEvent]"+k.message)}}return f.key}}},destroy:function(){d={};c=1}}});
STK.register("core.util.browser",function(a){var b=navigator.userAgent.toLowerCase(),c=window.external||"",d,e,f,g,h,i=function(a){var b=0;return parseFloat(a.replace(/\./g,function(){return b++==1?"":"."}))};try{/windows|win32/i.test(b)?h="windows":/macintosh/i.test(b)?h="macintosh":/rhino/i.test(b)&&(h="rhino");if((e=b.match(/applewebkit\/([^\s]*)/))&&e[1]){d="webkit";g=i(e[1])}else if((e=b.match(/presto\/([\d.]*)/))&&e[1]){d="presto";g=i(e[1])}else if(e=b.match(/msie\s([^;]*)/)){d="trident";g=1;(e=b.match(/trident\/([\d.]*)/))&&e[1]&&(g=i(e[1]))}else if(/gecko/.test(b)){d="gecko";g=1;(e=b.match(/rv:([\d.]*)/))&&e[1]&&(g=i(e[1]))}/world/.test(b)?f="world":/360se/.test(b)?f="360":/maxthon/.test(b)||typeof c.max_version=="number"?f="maxthon":/tencenttraveler\s([\d.]*)/.test(b)?f="tt":/se\s([\d.]*)/.test(b)&&(f="sogou")}catch(j){}var k={OS:h,CORE:d,Version:g,EXTRA:f?f:!1,IE:/msie/.test(b),OPERA:/opera/.test(b),MOZ:/gecko/.test(b)&&!/(compatible|webkit)/.test(b),IE5:/msie 5 /.test(b),IE55:/msie 5.5/.test(b),IE6:/msie 6/.test(b),IE7:/msie 7/.test(b),IE8:/msie 8/.test(b),IE9:/msie 9/.test(b),SAFARI:!/chrome\/([\d.]*)/.test(b)&&/\/([\d.]*) safari/.test(b),CHROME:/chrome\/([\d.]*)/.test(b),IPAD:/\(ipad/i.test(b),IPHONE:/\(iphone/i.test(b),ITOUCH:/\(itouch/i.test(b),MOBILE:/mobile/i.test(b)};return k});
STK.register("core.evt.getEvent",function(a){return function(){if(a.IE)return window.event;if(window.event)return window.event;var b=arguments.callee.caller,c,d=0;while(b!=null&&d<40){c=b.arguments[0];if(!(!c||c.constructor!=Event&&c.constructor!=MouseEvent&&c.constructor!=KeyboardEvent))return c;d++;b=b.caller}return c}});
STK.register("core.evt.fixEvent",function(a){return function(b){b=b||a.core.evt.getEvent();if(!b.target){b.target=b.srcElement;b.pageX=b.x;b.pageY=b.y}typeof b.layerX=="undefined"&&(b.layerX=b.offsetX);typeof b.layerY=="undefined"&&(b.layerY=b.offsetY);return b}});
STK.register("core.util.scrollPos",function(a){return function(a){a=a||document;var b=a.documentElement,c=a.body;return{top:Math.max(window.pageYOffset||0,b.scrollTop,c.scrollTop),left:Math.max(window.pageXOffset||0,b.scrollLeft,c.scrollLeft)}}});
STK.register("kit.util.drag",function(a){var b=function(a){a.cancelBubble=!0;return!1},c=function(b,c){b.clientX=c.clientX;b.clientY=c.clientY;b.pageX=c.clientX+a.core.util.scrollPos().left;b.pageY=c.clientY+a.core.util.scrollPos().top;b.offsetX=c.offsetX||c.layerX;b.offsetY=c.offsetY||c.layerY;b.target=c.target||c.srcElement;return b};return function(d,e){if(!a.core.dom.isNode(d))throw"core.util.drag need Element as first parameter";var f=a.core.obj.parseParam({actRect:[],actObj:{}},e),g={},h=a.core.evt.custEvent.define(f.actObj,"dragStart"),i=a.core.evt.custEvent.define(f.actObj,"dragEnd"),j=a.core.evt.custEvent.define(f.actObj,"draging"),k=function(d){var e=c({},d);document.body.onselectstart=function(){return!1};a.core.evt.addEvent(document,"mousemove",l);a.core.evt.addEvent(document,"mouseup",m);a.core.evt.addEvent(document,"click",b,!0);if(!a.IE){d.preventDefault();d.stopPropagation()}a.core.evt.custEvent.fire(h,"dragStart",e);return!1},l=function(b){var d=c({},b);b.cancelBubble=!0;a.core.evt.custEvent.fire(h,"draging",d)},m=function(d){var e=c({},d);document.body.onselectstart=function(){return!0};a.core.evt.removeEvent(document,"mousemove",l);a.core.evt.removeEvent(document,"mouseup",m);a.core.evt.removeEvent(document,"click",b,!0);a.core.evt.custEvent.fire(h,"dragEnd",e)};a.core.evt.addEvent(d,"mousedown",k);g.destroy=function(){a.core.evt.removeEvent(d,"mousedown",k);f=null};g.getActObj=function(){return f.actObj};return g}});
STK.register("common.widget.dragScroll",function(a){var b={},c=a.core.evt.addEvent,d=a.core.evt.custEvent;return function(e){var f,g,h,i,j,k,l,m,n,o,p=!1,q={contentOuter:null,contentInner:null,dragOuter:null,dragInner:null,dragInnerMinHeight:null};q=a.parseParam(q,e);var r=function(b){var b=b||window.event,c=b.target||b.srcElement;k=a.core.dom.position(h);var d=b.clientY-k.t,e;if(c!=i){e=parseInt(d*g.offsetHeight/h.offsetHeight,10);e>=Math.abs(f.offsetHeight-g.offsetHeight)&&(e=g.offsetHeight-f.offsetHeight);if(d<0)return;d+i.offsetHeight>h.offsetHeight&&(d=h.offsetHeight-i.offsetHeight);e>=Math.abs(f.offsetHeight-g.offsetHeight)&&(e=g.offsetHeight-f.offsetHeight);i.style.top=d+"px";g.style.marginTop=-1*e+"px"}},s=function(b){a.core.evt.stopEvent(b);var c=b.wheelDelta/120||b.detail/-3,d;if(!(Math.abs(c)>1)){if(c>0&&g.offsetTop>=0){d=0;return}if(c<0&&g.offsetTop<=f.offsetHeight-g.offsetHeight){d=0;return}d=c*40;c>0&&Math.abs(g.offsetTop)<d&&(d=c*Math.abs(g.offsetTop));c<0&&Math.abs(g.offsetTop-(f.offsetHeight-g.offsetHeight))<Math.abs(d)&&(d=c*Math.abs(g.offsetTop-(f.offsetHeight-g.offsetHeight)));t(d,c)}},t=function(a,b){var c,d;c=g.offsetTop+a;g.style.marginTop=c+"px";d=Math.round(c*h.offsetHeight/g.offsetHeight);i.style.top=-1*d+"px";g.offsetTop>=0?i.style.top="0px":g.offsetTop<=f.offsetHeight-g.offsetHeight&&(i.style.top=h.offsetHeight-i.offsetHeight+"px")},u={dragStart:function(a,b){m=b.offsetY},draging:function(b,c){var d,e,j,k=a.core.util.scrollPos();e=c.clientY-m-l.t+k.top;if(e<0)g.style.marginTop="0px";else{if(e+i.offsetHeight>h.offsetHeight){g.style.marginTop=f.offsetHeight-g.offsetHeight+"px";return}j=parseInt(e*g.offsetHeight/h.offsetHeight,10);if(j>=Math.abs(f.offsetHeight-g.offsetHeight))return;i.style.top=e+"px";g.style.marginTop=-1*j+"px"}},dragEnd:function(a,b){},dragMove:function(a){var b;b=g.offsetTop+a-j.t;g.style.marginTop=b+"px"}},v=function(a){document.attachEvent&&f.attachEvent("onmousewheel",s);if(document.addEventListener){f.addEventListener("mousewheel",s,!1);f.addEventListener("DOMMouseScroll",s,!1)}},w=function(a){document.attachEvent&&f.detachEvent("onmousewheel",s);if(document.addEventListener){f.removeEventListener("mousewheel",s,!1);f.removeEventListener("DOMMouseScroll",s,!1)}},x=function(){w();d.remove(drag.getActObj(),"dragStart",u.dragStart);d.remove(drag.getActObj(),"draging",u.draging)},y=function(){if(p){g.style.height=f.offsetHeight+"px";g.style.minHeight="";g.style.overflowY="scroll";h.style.display="none";i.style.display="none";x()}else{if(g.offsetHeight<=f.offsetHeight){g.style.marginTop="0px";i.style.height="0px";h.style.display="none";x();return}var b;h.style.display="block";j=a.core.dom.position(f);n=parseInt(f.offsetHeight*h.offsetHeight/g.offsetHeight,10);i.style.height=n+"px";b=-1*q.contentInner.offsetTop*q.dragOuter.offsetHeight/q.contentInner.offsetHeight;q.dragInner.style.top=b+"px";k=a.core.dom.position(h);if(g.offsetTop<=f.offsetHeight-g.offsetHeight){g.style.marginTop=f.offsetHeight-g.offsetHeight+"px";i.style.top=h.offsetHeight-i.offsetHeight+"px"}w();v()}},z=function(){if(q.contentOuter==null||q.contentInner==null||q.dragOuter==null||q.dragInner==null)throw"node is node defined"},A=function(){f=q.contentOuter;g=q.contentInner;h=q.dragOuter;i=q.dragInner},B=function(){drag=a.kit.util.drag(i);v();c(h,"click",r);d.add(drag.getActObj(),"dragStart",u.dragStart);d.add(drag.getActObj(),"draging",u.draging)},C=function(){var b=a.core.util.browser;p=b.MOBILE;if(p){g.style.height=f.offsetHeight+"px";g.style.minHeight="";g.style.overflowY="scroll";h.style.display="none";i.style.display="none";x()}else{if(g.offsetHeight<=f.offsetHeight){i.style.height="0px";h.style.display="none";x();return}h.style.display="block";g.style.marginTop="0px";i.style.top="0px";j=a.core.dom.position(f);k=a.core.dom.position(h);l=a.core.dom.position(i);n=Math.round(f.offsetHeight*h.offsetHeight/g.offsetHeight);q.dragInnerMinHeight&&(n=n>q.dragInnerMinHeight?n:q.dragInnerMinHeight);i.style.height=n+"px";o=i.offsetTop}},D=function(){z();A();B();C()};D();b.elmMove=t;b.init=C;b.destroy=x;b.reset=y;return b}});
STK.register("module.tabs",function(a){return function(b,c){function n(b,c){f=c.callback;h=c.className;j=c.defaultIndex;d=typeof c.tabNode=="string"?a.sizzle(c.tabNode,b):c.tabNode;i=d.length;c.boxNode!==""&&(e=typeof c.boxNode=="string"?a.sizzle(c.boxNode,b):c.boxNode);m();for(var g=0;g<i;g++)a.addEvent(d[g],c.evtType,function(b){return function(){a.preventDefault();l(b)}}(g))}function m(){if(!a.isArray(d))throw"module.tab needs tabNode as Array!";if(k.boxNode!==""){if(!a.isArray(e))throw"module.tab needs tabNode as Array!";if(d.length!=e.length)throw"module.tab needs tabNode'length equal to boxNode'length!"}}function l(b){if(b!=j){var c=a.isArray(f)?f[b]:f,g=d[b],i=a.isArray(e)?e[b]:null;if(i){a.setStyle(e[j],"display","none");a.setStyle(e[b],"display","")}a.removeClassName(d[j],h);a.addClassName(d[b],h);c({index:b,tabNode:g,boxNode:i});j=b}}var d,e,f,g,h,i,j,k=a.parseParam({evtType:"click",tabNode:"",boxNode:"",className:"current",callback:function(){},defaultIndex:0},c);n(b,k)}});
STK.register("kit.extra.language",function(a){window.$LANG||(window.$LANG={});return function(b,c){var d=a.core.util.language(b,$LANG);d=d.replace(/\\}/ig,"}");c&&(d=a.templet(d,c));return d}});
STK.register("kit.extra.merge",function(a){return function(a,b){var c={};for(var d in a)c[d]=a[d];for(var d in b)c[d]=b[d];return c}});
STK.register("core.str.trim",function(a){return function(a){if(typeof a!="string")throw"trim need a string as parameter";var b=a.length,c=0,d=/(\u3000|\s|\t|\u00A0)/;while(c<b){if(!d.test(a.charAt(c)))break;c+=1}while(b>c){if(!d.test(a.charAt(b-1)))break;b-=1}return a.slice(c,b)}});
STK.register("core.json.jsonToQuery",function(a){var b=function(b,c){b=b==null?"":b;b=a.core.str.trim(b.toString());return c?encodeURIComponent(b):b};return function(a,c){var d=[];if(typeof a=="object")for(var e in a){if(e==="$nullName"){d=d.concat(a[e]);continue}if(a[e]instanceof Array)for(var f=0,g=a[e].length;f<g;f++)d.push(e+"="+b(a[e][f],c));else typeof a[e]!="function"&&d.push(e+"="+b(a[e],c))}return d.length?d.join("&"):""}});
STK.register("common.log.monitor",function(a){var b="http://www.weibojs.com/log/widget.php",c={refer:document.referrer,title:document.title,ua:window.navigator.userAgent,os:window.navigator.platform+"|"+window.navigator.oscpu},d=!0,e=function(a){var b=new Image;d&&(b.src=a);b=null};return function(d){var f={},g=a.kit.extra.merge(c,d),h=[];for(var i in g){var j=g[i];typeof j=="object"&&(j=a.core.json.jsonToQuery(j));h.push(i+"="+encodeURIComponent(j))}var k=b+"?"+h.join("&");e(k);f.monitor=e;return f}});
STK.register("kit.io.ajax",function(a){return function(b){var c,d,e,f,g,h,i,j=function(b){a.common.log.monitor({url:document.location.protocol+"//"+document.location.hostname+(c.url.charAt(0)=="/"?c.url:"/"+c.url),param:c.args,method:c.method,result:b&&(b.code||0),httpcode:f.status})};h=function(a){g=!1;b.onComplete(a,c.args);setTimeout(k,0)};i=function(a){g=!1;b.onFail&&b.onFail(a,c.args);j(a);setTimeout(k,0)};e=[];f=null;g=!1;c=a.parseParam({url:"",method:"get",responseType:"json",timeout:3e4,onTraning:a.funcEmpty,isEncode:!0},b);c.onComplete=h;c.onFail=i;var k=function(){if(!!e.length){if(g===!0)return;g=!0;c.args=e.shift();f=a.ajax(c)}},l=function(a){while(e.length)e.shift();g=!1;if(f)try{f.abort()}catch(b){}f=null};d={};d.request=function(a){a||(a={});b.noQueue&&l();if(!b.uniqueRequest||!f){e.push(a);a._t=0;k()}};d.abort=l;return d}});
STK.register("kit.io.jsonp",function(a){return function(b){var c,d,e,f,g;c=a.parseParam({url:"",method:"get",responseType:"json",varkey:"_v",timeout:3e4,onComplete:a.funcEmpty,onTraning:a.funcEmpty,onFail:a.funcEmpty,isEncode:!0},b);e=[];f={};g=!1;var h=function(){if(!!e.length){if(g===!0)return;g=!0;f.args=e.shift();f.onComplete=function(a){g=!1;c.onComplete(a,f.args);setTimeout(h,0)};f.onFail=function(a){g=!1;c.onFail(a);setTimeout(h,0)};a.jsonp(a.kit.extra.merge(c,{args:f.args,onComplete:function(a){f.onComplete(a)},onFail:function(a){try{f.onFail(a)}catch(b){}}}))}};d={};d.request=function(a){a||(a={});e.push(a);a._t=1;h()};d.abort=function(a){while(e.length)e.shift();g=!1;f=null};return d}});
STK.register("kit.io.inter",function(a){return function(){var b,c,d;b={};c={};d={};b.register=function(a,b){if(c[a]!==undefined)throw a+" interface has been registered";c[a]=b;d[a]={}};b.hookComplete=function(b,c){var e=a.core.util.getUniqueKey();d[b][e]=c;return e};b.removeHook=function(a,b){d[a]&&d[a][b]&&delete d[a][b]};b.getTrans=function(b,e){var f=a.kit.extra.merge(c[b],e);f.onComplete=function(a,c){try{e.onComplete(a,c)}catch(f){}if(a.code==="100000")try{e.onSuccess(a,c)}catch(f){}else try{e.onError(a,c)}catch(f){}for(var g in d[b])try{d[b][g](a,c)}catch(f){}};return c[b].requestMode==="jsonp"?a.kit.io.jsonp(f):c[b].requestMode==="ijax"?a.kit.io.ijax(f):a.kit.io.ajax(f)};b.request=function(b,e,f){var g=a.core.json.merge(c[b],e);g.onComplete=function(a,c){try{e.onComplete(a,c)}catch(f){}if(a.code==="100000")try{e.onSuccess(a,c)}catch(f){}else try{if(a.code==="100002"){window.location.href=a.data;return}e.onError(a,c)}catch(f){}for(var g in d[b])try{d[b][g](a,c)}catch(f){}};g=a.core.obj.cut(g,["noqueue"]);g.args=f;return c[b].requestMode==="jsonp"?a.jsonp(g):c[b].requestMode==="ijax"?a.ijax(g):a.ajax(g)};return b}});
STK.register("common.trans.list",function(a){var b=a.kit.io.inter(),c=b.register,d="";/weibo.com/.test(location.host)||(d="/widget");c("getnewmblog",{url:d+"/list/aj_getnewmblog.php",method:"get"});c("getmember",{url:d+"/list/aj_getmember.php",method:"get"});c("attuser",{url:d+"/list/aj_attuser.php",method:"get"});c("addcomment",{url:d+"/public/aj_comment.php",method:"post"});c("repostmblog",{url:d+"/list/aj_repostmblog.php",method:"post"});c("memberfeed",{url:d+"/list/aj_getmblogbyuid.php",method:"get"});c("allcomments",{url:d+"/public/aj_commentlist.php",method:"get"});c("reply",{url:d+"/public/aj_replycomment.php",method:"post"});c("allreposts",{url:d+"/public/aj_getretlist.php",method:"get"});c("portrait",{url:d+"/list/aj_getmember.php",method:"get"});return b});
STK.register("kit.dom.firstChild",function(a){var b=a.core.dom.next;return function(a){var c=a.firstChild;c&&c.nodeType!=1&&(c=b(c));return c}});
STK.register("comp.widget.list.feed",function(a){var b=a.kit.extra.language,c=a.common.trans.list,d=$CONFIG.$language?$CONFIG.$language:"zh_cn",e;return function(e,f){var g={},h=!1,i=0,j,k=!0,l=scope.$load_time||12e4,m,n=function(){o();p();u()},o=function(){if(!e)throw"no available node found"},p=function(){a.addEvent(e,"mouseover",function(){clearInterval(j)});a.addEvent(e,"mouseout",function(){clearInterval(j);q()})},q=function(){k&&(j=setInterval(r,l))},r=function(){if(!(i>=6||h)){h=!0;var g=c.getTrans("getnewmblog",{onComplete:function(b,c){var d=b.data;if(b.code=="A00006"&&d){d&&d.since_id&&(scope.$feedInfo.since_id=d.since_id);var g=d.html;if(g){var n=a.builder(g),o=a.kit.dom.firstChild(e),p=a.kit.dom.parseDOM(a.builder(e).list);p.feed_list.innerHTML=g;i++;scope.$feedInfo.max_id=b.data.max_id;m=a.common.widget.dragScroll(f);contentTemp=e.innerHTML}}if(b.time){clearInterval(j);l=b.time*1e3;l<0&&(k=!1)}h=!1},onFail:function(){h=!1;a.ui.alert(b("#L{请求失败，请稍候再试}"))}});g.request({app_src:scope.$appsrc,listid:scope.$listid,uid:scope.$oid,since_id:scope.$feedInfo.since_id||"",language:d})}},s=function(a,b){var c=-104;if(b&&b.last){m.elmMove(c);setTimeout(function(){b.target&&b.target.focus()},300)}m!=null&&m.reset()},t=function(b){m!=null&&m.destroy();setTimeout(function(){m=a.common.widget.dragScroll(f)},100)},u=function(){r()},v=function(){clearInterval(j);m!=null&&m.destroy()};n();g.reset=s;g.destroy=v;g.rebuildScroll=t;return g}});
STK.register("kit.extra.reuse",function(a){return function(b,c){var d,e,f;d=a.parseParam({},c);f=[];var g=function(){var a=b();f.push({store:a,used:!0});return a},h=function(b){a.foreach(f,function(a,c){if(b===a.store){a.used=!0;return!1}})},i=function(b){a.foreach(f,function(a,c){if(b===a.store){a.used=!1;return!1}})},j=function(){for(var a=0,b=f.length;a<b;a+=1)if(f[a].used===!1){f[a].used=!0;return f[a].store}return g()};e={};e.setUsed=h;e.setUnused=i;e.getOne=j;e.getLength=function(){return f.length};return e}});
STK.register("module.layer",function(a){var b=function(a){var b={};if(a.style.display=="none"){a.style.visibility="hidden";a.style.display="";b.w=a.offsetWidth;b.h=a.offsetHeight;a.style.display="none";a.style.visibility="visible"}else{b.w=a.offsetWidth;b.h=a.offsetHeight}return b},c=function(c,d){d=d||"topleft";var e=null;if(c.style.display=="none"){c.style.visibility="hidden";c.style.display="";e=a.core.dom.position(c);c.style.display="none";c.style.visibility="visible"}else e=a.core.dom.position(c);if(d!=="topleft"){var f=b(c);if(d==="topright")e.l=e.l+f.w;else if(d==="bottomleft")e.t=e.t+f.h;else if(d==="bottomright"){e.l=e.l+f.w;e.t=e.t+f.h}}return e};return function(d){var e=a.core.dom.builder(d),f=e.list.outer[0],g=e.list.inner[0],h=a.core.dom.uniqueID(f),i={},j=a.core.evt.custEvent.define(i,"show");a.core.evt.custEvent.define(j,"hide");var k=null;i.show=function(){f.style.display="";a.core.evt.custEvent.fire(j,"show");return i};i.hide=function(){f.style.display="none";a.custEvent.fire(j,"hide");return i};i.getPosition=function(a){return c(f,a)};i.getSize=function(a){if(a||!k)k=b.apply(i,[f]);return k};i.html=function(a){a!==undefined&&(g.innerHTML=a);return g.innerHTML};i.text=function(b){text!==undefined&&(g.innerHTML=a.core.str.encodeHTML(b));return a.core.str.decodeHTML(g.innerHTML)};i.appendChild=function(a){g.appendChild(a);return i};i.getUniqueID=function(){return h};i.getOuter=function(){return f};i.getInner=function(){return g};i.getParentNode=function(){return f.parentNode};i.getDomList=function(){return e.list};i.getDomListByKey=function(a){return e.list[a]};i.getDom=function(a,b){return e.list[a]?e.list[a][b||0]:!1};i.getCascadeDom=function(b,c){return e.list[b]?a.core.dom.cascadeNode(e.list[b][c||0]):!1};return i}});
STK.register("module.dialog",function(a){return function(b,c){if(!b)throw"module.dialog need template as first parameter";var d,e,f,g,h,i,j,k,l,m,n,o;l=!0;var p=function(){l!==!1&&e.hide()},q=function(){d=a.parseParam({t:null,l:null,width:null,height:null},c);e=a.module.layer(b,d);g=e.getOuter();h=e.getDom("title");k=e.getDom("title_content");i=e.getDom("inner");j=e.getDom("close");a.addEvent(j,"click",function(){n()});a.custEvent.add(e,"show",function(){a.hotKey.add(document.documentElement,["esc"],p,{type:"keyup",disableInInput:!0})});a.custEvent.add(e,"hide",function(){a.hotKey.remove(document.documentElement,["esc"],p,{type:"keyup"});l=!0})};q();o=a.objSup(e,["show","hide"]);n=function(b){if(typeof m=="function"&&!b&&m()===!1)return!1;o.hide();a.contains(document.body,e.getOuter())&&document.body.removeChild(e.getOuter());return f};f=e;f.show=function(){a.contains(document.body,e.getOuter())||document.body.appendChild(e.getOuter());o.show();return f};f.hide=n;f.setPosition=function(a){g.style.top=a.t+"px";g.style.left=a.l+"px";return f};f.setMiddle=function(){var b=a.core.util.winSize(),c=e.getSize(!0);g.style.top=a.core.util.scrollPos().top+(b.height-c.h)/2+"px";g.style.left=(b.width-c.w)/2+"px";return f};f.setTitle=function(a){k.innerHTML=a;return f};f.setContent=function(a){typeof a=="string"?i.innerHTML=a:i.appendChild(a);return f};f.clearContent=function(){while(i.children.length)a.removeNode(i.children[0]);return f};f.setAlign=function(){};f.setBeforeHideFn=function(a){m=a};f.clearBeforeHideFn=function(){m=null};f.unsupportEsc=function(){l=!1};f.supportEsc=function(){l=!0};return f}});
STK.register("kit.dom.cssText",function(a){var b=function(a,b){var c=(a+";"+b).replace(/(\s*(;)\s*)|(\s*(:)\s*)/g,"$2$4"),d;while(c&&(d=c.match(/(^|;)([\w\-]+:)([^;]*);(.*;)?\2/i)))c=c.replace(d[1]+d[2]+d[3],"");return c};return function(a){a=a||"";var c=[],d={push:function(a,b){c.push(a+":"+b);return d},remove:function(a){for(var b=0;b<c.length;b++)c[b].indexOf(a+":")==0&&c.splice(b,1);return d},getStyleList:function(){return c.slice()},getCss:function(){return b(a,c.join(";"))}};return d}});
STK.register("kit.dom.fix",function(a){function f(c,e,f){if(!!d(c)){var g="fixed",h,i,j,k,l=c.offsetWidth,m=c.offsetHeight,n=a.core.util.winSize(),o=0,p=0,q=a.kit.dom.cssText(c.style.cssText);if(!b){g="absolute";var r=a.core.util.scrollPos();o=h=r.top;p=i=r.left;switch(e){case"lt":h+=f[1];i+=f[0];break;case"lb":h+=n.height-m-f[1];i+=f[0];break;case"rt":h+=f[1];i+=n.width-l-f[0];break;case"rb":h+=n.height-m-f[1];i+=n.width-l-f[0];break;case"c":default:h+=(n.height-m)/2+f[1];i+=(n.width-l)/2+f[0]}j=k=""}else{h=k=f[1];i=j=f[0];switch(e){case"lt":k=j="";break;case"lb":h=j="";break;case"rt":i=k="";break;case"rb":h=i="";break;case"c":default:h=(n.height-m)/2+f[1];i=(n.width-l)/2+f[0];k=j=""}}if(e=="c"){h<o&&(h=o);i<p&&(i=p)}q.push("position",g).push("top",h+"px").push("left",i+"px").push("right",j+"px").push("bottom",k+"px");c.style.cssText=q.getCss()}}function e(b){b=a.core.arr.isArray(b)?b:[0,0];for(var c=0;c<2;c++)typeof b[c]!="number"&&(b[c]=0);return b}function d(b){return a.core.dom.getStyle(b,"display")!="none"}var b=!(a.core.util.browser.IE6||document.compatMode!=="CSS1Compat"&&STK.IE),c=/^(c)|(lt)|(lb)|(rt)|(rb)$/;return function(d,g,h){var i,j,k=!0,l;if(a.core.dom.isNode(d)&&c.test(g)){var m={getNode:function(){return d},isFixed:function(){return k},setFixed:function(a){(k=!!a)&&f(d,i,j);return this},setAlign:function(a,b){if(c.test(a)){i=a;j=e(b);k&&f(d,i,j)}return this},destroy:function(){b||b&&a.core.evt.removeEvent(window,"scroll",n);a.core.evt.removeEvent(window,"resize",n);a.core.evt.custEvent.undefine(l)}};l=a.core.evt.custEvent.define(m,"beforeFix");m.setAlign(g,h);function n(c){c=c||window.event;a.core.evt.custEvent.fire(l,"beforeFix",c.type);k&&(!b||i=="c")&&f(d,i,j)}b||a.core.evt.addEvent(window,"scroll",n);a.core.evt.addEvent(window,"resize",n);return m}}});
STK.register("module.mask",function(a){function k(b){var c;(c=b.getAttribute(f))||b.setAttribute(f,c=a.getUniqueKey());return">"+b.tagName.toLowerCase()+"["+f+'="'+c+'"]'}function j(){b=a.C("div");var c='<div node-type="outer">';a.core.util.browser.IE6&&(c+='<div style="position:absolute;width:100%;height:100%;"></div>');c+="</div>";b=a.builder(c).list.outer[0];document.body.appendChild(b);e=!0;d=a.kit.dom.fix(b,"lt");var f=function(){var c=a.core.util.winSize();b.style.cssText=a.kit.dom.cssText(b.style.cssText).push("width",c.width+"px").push("z-index","99995").push("height",c.height+"px").getCss()};i.add(d,"beforeFix",f);f()}var b,c=[],d,e=!1,f="STK-Mask-Key",g=a.core.dom.setStyle,h=a.core.dom.getStyle,i=a.core.evt.custEvent,l={getNode:function(){return b},show:function(c,f){if(e){c=a.core.obj.parseParam({opacity:.3,background:"#000000"},c);b.style.background=c.background;g(b,"opacity",c.opacity);b.style.display="";d.setAlign("lt");f&&f()}else a.Ready(function(){j();l.show(c,f)});return l},hide:function(){b.style.display="none";nowIndex=undefined;c=[];return l},showUnderNode:function(d,e){a.isNode(d)&&l.show(e,function(){g(b,"zIndex",h(d,"zIndex"));var e=k(d),f=a.core.arr.indexOf(c,e);f!=-1&&c.splice(f,1);c.push(e);a.core.dom.insertElement(d,b,"beforebegin")});return l},back:function(){if(c.length<1)return l;var d,e;c.pop();if(c.length<1)l.hide();else if((e=c[c.length-1])&&(d=a.sizzle(e,document.body)[0])){g(b,"zIndex",h(d,"zIndex"));a.core.dom.insertElement(d,b,"beforebegin")}else l.back();return l},destroy:function(){i.remove(d);b.style.display="none";lastNode=undefined;_cache={}}};return l});
STK.register("kit.dom.drag",function(a){return function(b,c){var d,e,f,g,h,i,j,k,l=function(){m();n()},m=function(){d=a.parseParam({moveDom:b,perchStyle:"border:solid #999999 2px;",dragtype:"perch",actObj:{},pagePadding:5},c);f=d.moveDom;e={};g={};h=a.drag(b,{actObj:d.actObj});if(d.dragtype==="perch"){i=a.C("div");j=!1;k=!1;f=i}b.style.cursor="move"},n=function(){a.custEvent.add(d.actObj,"dragStart",o);a.custEvent.add(d.actObj,"dragEnd",p);a.custEvent.add(d.actObj,"draging",q)},o=function(c,e){document.body.style.cursor="move";var f=a.core.util.pageSize().page;g=a.core.dom.position(d.moveDom);g.pageX=e.pageX;g.pageY=e.pageY;g.height=d.moveDom.offsetHeight;g.width=d.moveDom.offsetWidth;g.pageHeight=f.height;g.pageWidth=f.width;if(d.dragtype==="perch"){var h=[];h.push(d.perchStyle);h.push("position:absolute");h.push("z-index:"+(d.moveDom.style.zIndex+10));h.push("width:"+d.moveDom.offsetWidth+"px");h.push("height:"+d.moveDom.offsetHeight+"px");h.push("left:"+g.l+"px");h.push("top:"+g.t+"px");i.style.cssText=h.join(";");k=!0;setTimeout(function(){if(k){document.body.appendChild(i);j=!0}},100)}b.setCapture!==undefined&&b.setCapture()},p=function(a,c){document.body.style.cursor="auto";b.setCapture!==undefined&&b.releaseCapture();if(d.dragtype==="perch"){k=!1;d.moveDom.style.top=i.style.top;d.moveDom.style.left=i.style.left;if(j){document.body.removeChild(i);j=!1}}},q=function(a,b){var c=g.t+(b.pageY-g.pageY),e=g.l+(b.pageX-g.pageX),h=c+g.height,i=e+g.width,j=g.pageHeight-d.pagePadding,k=g.pageWidth-d.pagePadding;if(h<j&&c>0)f.style.top=c+"px";else{c<0&&(f.style.top="0px");h>=j&&(f.style.top=j-g.height+"px")}if(i<k&&e>0)f.style.left=e+"px";else{e<0&&(f.style.left="0px");i>=k&&(f.style.left=k-g.width+"px")}};l();e.destroy=function(){document.body.style.cursor="auto";typeof f.setCapture=="function"&&f.releaseCapture();if(d.dragtype==="perch"){k=!1;if(j){document.body.removeChild(i);j=!1}}a.custEvent.remove(d.actObj,"dragStart",o);a.custEvent.remove(d.actObj,"dragEnd",p);a.custEvent.remove(d.actObj,"draging",q);h.destroy&&h.destroy();d=null;f=null;g=null;h=null;i=null;j=null;k=null};e.getActObj=function(){return d.actObj};return e}});
STK.register("ui.dialog",function(a){var b='<div class="W_layer" node-type="outer" style="display:none;position:absolute;z-index:10001"><div class="bg"><table border="0" cellspacing="0" cellpadding="0"><tr><td><div class="content"><div class="title" node-type="title"><span node-type="title_content"></span></div><a href="javascript:void(0);" class="W_close" title="#L{关闭}" node-type="close"></a><div node-type="inner"></div></div></td></tr></table></div></div>',c=a.kit.extra.language,d=null,e=function(){var d=a.module.dialog(c(b));a.custEvent.add(d,"show",function(){a.module.mask.showUnderNode(d.getOuter())});a.custEvent.add(d,"hide",function(){a.module.mask.back();d.setMiddle()});a.kit.dom.drag(d.getDom("title"),{actObj:d,moveDom:d.getOuter()});d.destroy=function(){f(d);try{d.hide(!0)}catch(a){}};return d},f=function(a){a.setTitle("").clearContent();d.setUnused(a)};return function(b){var c=a.parseParam({isHold:!1},b),g=c.isHold;c=a.core.obj.cut(c,["isHold"]);d||(d=a.kit.extra.reuse(e));var h=d.getOne();g||a.custEvent.add(h,"hide",function(){a.custEvent.remove(h,"hide",arguments.callee);f(h)});return h}});
STK.register("ui.alert",function(a){var b='<div node-type="outer" class="layer_point"><dl class="point clearfix"><dt><span class="" node-type="icon"></span></dt><dd node-type="inner"><p class="W_texta" node-type="textLarge"></p><p class="W_textb" node-type="textSmall"></p></dd></dl><div class="btn"><a href="javascript:void(0)" class="W_btn_b" node-type="OK"></a></div></div>',c={success:"icon_succM",error:"icon_errorM",warn:"icon_warnM","delete":"icon_delM",question:"icon_questionM"},d=a.kit.extra.language,e=null,f=function(a,b){a.getDom("icon").className=b.icon;a.getDom("textLarge").innerHTML=b.textLarge;a.getDom("textSmall").innerHTML=b.textSmall;a.getDom("OK").innerHTML="<span>"+b.OKText+"</span>"};return function(g,h){var i,j,k,l,m;i=a.parseParam({title:d("#L{提示}"),icon:"warn",textLarge:g,textSmall:"",OK:a.funcEmpty,OKText:d("#L{确定}"),timeout:0},h);i.icon=c[i.icon];j={};e||(e=a.kit.extra.reuse(function(){var c=a.module.layer(d(b));return c}));k=e.getOne();l=a.ui.dialog();l.setContent(k.getOuter());l.setTitle(i.title);f(k,i);a.addEvent(k.getDom("OK"),"click",l.hide);a.custEvent.add(l,"hide",function(){a.custEvent.remove(l,"hide",arguments.callee);a.removeEvent(k.getDom("OK"),"click",l.hide);e.setUnused(k);clearTimeout(m);i.OK()});i.timeout&&(m=setTimeout(l.hide,i.timeout));l.show().setMiddle();j.alt=k;j.dia=l;return j}});
STK.register("common.widget.log",function(a){var b={app_sharebutton:1,app_followbutton:2,app_livestream:4,app_listweibo:5,app_weiboshow:6,app_commentbox:7};return function(c){var d=a.core.obj.parseParam({vsrc:"app_weiboshow",refer:"",step:1},c),e=scope.refer||scope.$refer||d.refer,f=scope.loginKit().uid||"",g=scope.appkey||$CONFIG.$appkey||$CONFIG.appkey||0,h=b[d.vsrc]||"",i="http://rs.sinajs.cn/r.gif?uid="+f+"&appid="+g+"&refer="+e+"&cat="+h+"&step="+d.step+"&rnd="+ +(new Date),j=new Image;j.src=i;j=null}});
STK.register("common.widget.login",function(a){var b={vsrc:"app_weiboshow",appsrc:"",showlogo:0,callback:function(){}};typeof App=="undefined"&&(App={});return function(c){c=a.parseParam(b,c);c.appsrc||(c.appsrc=scope?scope.appsrc?scope.appsrc:scope.$appsrc?scope.$appsrc:"":"");var d={};App.loginBackUrlCallBack=function(b){a.custEvent.fire(d,"login",b);c.step=2;a.common.widget.log(c)};var e=function(){f();g();h();i()},f=function(){},g=function(){},h=function(){a.custEvent.define(d,"login")},i=function(){a.custEvent.add(d,"login",function(a){c.callback(a)})};d.showLogin=function(){var b="&"+a.jsonToQuery(c),d=navigator.userAgent.indexOf("360 Aphone Browser")>=0,e=/micromessenger\/(\d+\.\d+\.\d+)/i.test(navigator.userAgent);if(d||e)location.href="http://service.weibo.com/reg/loginindex.php?regbackurl=http%3A%2F%2Fweibo.com&backurl="+encodeURIComponent(location.href)+b+"&rnd="+ +(new Date).valueOf();else{var f="http://service.weibo.com/reg/loginindex.php?regbackurl=http%3A%2F%2Fweibo.com&backurl=http%3A%2F%2F"+location.host+"%2Fstaticjs%2FloginProxy.html"+b+"&rnd="+ +(new Date).valueOf();/weibo.com/.test(location.host)&&(f=f.replace(/\/widget/,""));var g=window.open(f,"miniblog_login",["toolbar=1,status=0,resizable=1,width=620,height=540,left=",(screen.width-620)/2,",top=",(screen.height-450)/2].join(""));g.focus();a.common.widget.log(c)}};e();return d}});
typeof scope=="undefined"&&(scope={});scope.loginKit=function(){if(window.scope){var a=window.scope.current_user_weibo||window.scope.current_user_sina;if(a)return{uid:a,isLogin:!!a}}if(window.$CONFIG){var a=window.$CONFIG.current_user_weibo||window.$CONFIG.current_user_sina;if(a)return{uid:a,isLogin:!!a}}var b=document.cookie+";",c=["SUP","=([^;]*)?;"].join(""),d=["(\\?|&)","uid","=([^&]*)(&|$)"].join(""),e=b.match(new RegExp(c,"i"));e=e?e[1]||"":"";e=unescape(e);var a=e.match(new RegExp(d));a=a?a[2]||"":"";var f=scope.$oid;return{uid:a,isLogin:!!a,isAdmin:a&&f&&a==f}};scope.$isLogin=function(){return scope.loginKit().isLogin};scope.$isAdmin=function(){return scope.loginKit().isAdmin};
STK.register("common.login.getLoginStatus",function(a){function d(){return b().isLogin}function c(){return b().uid}function b(){if(window.scope){var a=window.scope.current_user_weibo||window.scope.current_user_sina;if(a)return{uid:a,isLogin:!!a}}if(window.$CONFIG){var a=window.$CONFIG.current_user_weibo||window.$CONFIG.current_user_sina;if(a)return{uid:a,isLogin:!!a}}var b=document.cookie+";",c=["SUP","=([^;]*)?;"].join(""),d=["(\\?|&)","uid","=([^&]*)(&|$)"].join(""),e=b.match(new RegExp(c,"i"));e=e?e[1]||"":"";e=unescape(e);var a=e.match(new RegExp(d));a=a?a[2]||"":"";return{uid:a,isLogin:!!a}}return{uid:c,isLogin:d}});
STK.register("comp.widget.list.login",function(a){return function(b){var c=new Image;c.onload=function(){c.onload=null;c=null};var d=a.common.login.getLoginStatus.uid();c.src="http://rs.sinajs.cn/tmp.gif?id=list&uid="+d+"&action=login&listid="+$CONFIG.$listid+"&appkey="+$CONFIG.$appkey+"&refer="+encodeURIComponent(document.referrer);b&&b()}});
STK.register("comp.widget.list.follow",function(a){var b=a.kit.extra.language;return function(){var c={},d=!1,e=!1,f={cbk:function(c,d){var e=c.el;if(d.code=="A00006"){var f=a.C("span");if(c.el.className=="main_allList_addBtn")f.innerHTML=b("#L{已关注}");else{f.className="WB_btnC";c.data.type=="member"?f.innerHTML='<cite title="" href="#0" class="WB_follow_status"><cite class="WB_follow_status_inner"><cite class="WB_follow_box"><u class="WB_icon_followed"></u>已关注</cite></cite></cite>':c.data.type=="feed"&&(f.innerHTML='<cite title="" href="#0" class="WB_follow_status"><cite class="WB_follow_status_inner"><cite class="WB_follow_box"><u class="WB_icon_followed"></u>已关注</cite></cite></cite>')}e.parentNode.replaceChild(f,e)}},add:function(b){if(parent==self||parent==parent.parent){var c=b.data.type;if(!scope.$isLogin()){g.showLogin();return}e=$CONFIG.$tip=="1"?!0:!1;if(e){window.open("http://weibo.com/signup/full_info.php?appsrc=1JreRx&showlogo=0&backurl="+encodeURIComponent(document.URL)+"&nonick=1&lang=zh-cn&callback=http%3A%2F%2Fweibo.com");return}if(d)return;d=!0;var h=b.data.uid,i=a.common.trans.list,j=i.getTrans("attuser",{method:"post",onComplete:function(a,e){d=!1;f.cbk(b,a,c)},onFail:function(){d=!1}});j.request({uid:scope.$uid,fuid:h,refer:encodeURIComponent(document.referrer),listid:scope.$listid})}}},g=a.common.widget.login({vsrc:"app_listweibo",appsrc:scope.$appsrc||"",callback:a.comp.widget.list.login});c.add=f.add;return c}});
var $SYSMSG={zh_cn:{M01155:"不要太贪心哦，发一次就够啦。",M00009:"参数错误",M00003:"你尚未登录或登录已过期，请重新登录。"},zh_tw:{M01155:"不要太貪心哦，發一次就夠啦。",M00009:"參數錯誤",M00003:"你尚未登入或登入已逾時，請重新登入。"}},$SYSLANG=$SYSMSG[$CONFIG.$language?$CONFIG.$language:"zh_cn"];
STK.register("kit.dom.parentElementBy",function(a){return function(a,b,c){if(!a||!b)throw new Error("传入的参数为空");var d=0,e;a=a.parentNode;while(a.parentNode){d++;e=c(a);if(e===!1)return!1;if(e===!0)return a;if(e===b)return null;a=a.parentNode;if(d>3e4)return!1}return null}});
STK.register("kit.dom.isTurnoff",function(a){return function(a){return!a.parentNode||a.parentNode.nodeType==11||!!a.disabled}});
STK.register("kit.extra.textareaUtils",function(a){var b={},c=document.selection;b.selectionStart=function(a){if(!c)try{return a.selectionStart}catch(b){return 0}var d=c.createRange(),e,f,g=0,h=document.body.createTextRange();h.moveToElementText(a);for(g;h.compareEndPoints("StartToStart",d)<0;g++)h.moveStart("character",1);return g};b.selectionBefore=function(a){return a.value.slice(0,b.selectionStart(a))};b.selectText=function(a,b,d){a.focus();if(!c)a.setSelectionRange(b,d);else{var e=a.createTextRange();e.collapse(1);e.moveStart("character",b);e.moveEnd("character",d-b);e.select()}};b.insertText=function(a,d,e,f){a.focus();f=f||0;if(!c){var g=a.value,h=e-f,i=h+d.length;a.value=g.slice(0,h)+d+g.slice(e,g.length);b.selectText(a,i,i)}else{var j=c.createRange();j.moveStart("character",-f);j.text=d}};b.replaceText=function(a,d){a.focus();var e=a.value,f=b.getSelectedText(a),g=f.length;if(f.length==0)b.insertText(a,d,b.getCursorPos(a));else{var h=b.getCursorPos(a);if(!c){var j=h+f.length;a.value=e.slice(0,h)+d+e.slice(h+g,e.length);b.setCursor(a,h+d.length);return}var i=c.createRange();i.text=d;b.setCursor(a,h+d.length)}};b.getCursorPos=function(a){var b=0;if(STK.core.util.browser.IE){a.focus();var d=null;d=c.createRange();var e=d.duplicate();e.moveToElementText(a);e.setEndPoint("EndToEnd",d);a.selectionStart=e.text.length-d.text.length;a.selectionEnd=a.selectionStart+d.text.length;b=a.selectionStart}else if(a.selectionStart||a.selectionStart=="0")b=a.selectionStart;return b};b.getSelectedText=function(a){var b="",d=function(a){return a.selectionStart!=undefined&&a.selectionEnd!=undefined?a.value.substring(a.selectionStart,a.selectionEnd):""};window.getSelection?b=d(a):b=c.createRange().text;return b};b.setCursor=function(a,b,c){b=b==null?a.value.length:b;c=c==null?0:c;a.focus();if(a.createTextRange){var d=a.createTextRange();d.move("character",b);d.moveEnd("character",c);d.select()}else a.setSelectionRange(b,b+c)};b.unCoverInsertText=function(a,b,c){c=c==null?{}:c;c.rcs=c.rcs==null?a.value.length:c.rcs*1;c.rccl=c.rccl==null?0:c.rccl*1;var d=a.value,e=d.slice(0,c.rcs),f=d.slice(c.rcs+c.rccl,d==""?0:d.length);a.value=e+b+f;this.setCursor(a,c.rcs+(b==null?0:b.length))};return b});
STK.register("common.editor.getLength",function(a){return function(b){var c=41,d=140,e=20,f=b,g=b.match(/(http|https):\/\/[a-zA-Z0-9]+(\.[a-zA-Z0-9]+)+([-A-Z0-9a-z_\$\.\+\!\*\(\)\/\,\:;@&=\?~#%]*)*/gi)||[],h=0;for(var i=0,j=g.length;i<j;i++){var k=a.core.str.bLength(g[i]);if(/^(http:\/\/t.cn)/.test(g[i]))continue;/^(http:\/\/)+(t.sina.com.cn|t.sina.cn)/.test(g[i])||/^(http:\/\/)+(weibo.com|weibo.cn)/.test(g[i])?h+=k<=c?k:k<=d?e:k-d+e:h+=k<=d?e:k-d+e;f=f.replace(g[i],"")}var l=Math.ceil((h+a.core.str.bLength(f))/2);return l}});
STK.register("common.listener",function(a){var b={},c={};c.define=function(c,d){if(b[c]!=null)throw"common.listener.define: 频道已被占用";b[c]=d;var e={};e.register=function(d,e){if(b[c]==null)throw"common.listener.define: 频道未定义";a.listener.register(c,d,e)};e.fire=function(d,e){if(b[c]==null)throw"commonlistener.define: 频道未定义";a.listener.fire(c,d,e)};e.remove=function(b,d){a.listener.remove(c,b,d)};e.cache=function(b){return a.listener.cache(c,b)};return e};return c});
STK.register("module.at",function(a){var b=window,c=document,d=a.core.util.browser,e="font-family:Tahoma,宋体;",f=a.kit.extra.textareaUtils.selectionStart,g,h,i,j,k,l=function(){var a={"<":"&lt;",">":"&gt;",'"':"&quot;","\\":"&#92;","&":"&amp;","'":"&#039;","\r":"","\n":"<br>"," ":(navigator.userAgent.match(/.+(?:ie) ([\d.]+)/i)||[8])[1]<8?['<pre style="overflow:hidden;display:inline;',e,'word-wrap:break-word;"> </pre>'].join(""):['<span style="white-space:pre-wrap;',e,'"> </span>'].join("")};return function(b){var c=b.replace(/(<|>|\"|\\|&|\'|\n|\r| )/g,function(b){return a[b]});return c}}(),m=function(){var b=[],c=g.textEl.style.cssText,d;a.foreach(["margin","padding","border"],function(c){a.foreach(["Top","Left","Bottom","Right"],function(d){var e;c!="border"?e=b.push(c,"-",d.toLowerCase(),":",a.getStyle(g.textEl,c+d),";"):a.foreach(["Color","Style","Width"],function(e){b.push(c,"-",d.toLowerCase(),"-",e.toLowerCase(),":",a.getStyle(g.textEl,[c,d,e].join("")),";")})})});b.push("font-size:"+a.getStyle(g.textEl,"fontSize")+";");return a.kit.dom.cssText([c,b.join(""),e,"word-wrap: break-word;line-height: 18px;overflow-y:auto;overflow-x:hidden;outline:none;"].join("")).getCss()},n=function(){var b=a.builder(['<div node-type="wrap" style="display:none;">','<span node-type="before"></span>','<span node-type="flag"></span>','<span node-type="after"></span>',"</div>"].join("")).list,e=b.wrap[0],f=b.flag[0],h=b.after[0],i=b.before[0],j=0,n,o,p,q=function(a){return d.MOZ?-2:d.MOBILE&&d.SAFARI&&(d.IPAD||d.ITOUCH||d.IPHONE)?-2:0};return{bind:function(){if(o!==g.textEl){k=a.position(g.textEl);var b=["left:",k.l,"px;top:",k.t+20,"px;"].join("");o=g.textEl;var d=m();o.style.cssText=d;p=[b,d,"position:absolute;filter:alpha(opacity=0);opacity:0;z-index:-1000;"].join("");e.style.cssText=p;if(!j){j=1;c.body.appendChild(e)}}},content:function(b,c,d,j){e.style.cssText=[p,"width:",(o.offsetWidth||parseInt(a.getStyle(o,"width")))+q(),"px;height:",o.offsetHeight||parseInt(a.getStyle(o,"height")),"px;overflow-x:hidden;overflow-y:",/webkit/i.test(navigator.userAgent)?"hidden":a.getStyle(o,"overflowY"),";"].join("");i.innerHTML=l(b);f.innerHTML=l(c)||"&thinsp;";h.innerHTML=l([d,j].join(""));clearTimeout(n);n=setTimeout(function(){var b=a.position(f);a.custEvent.fire(g.eId,"at",{t:b.t-o.scrollTop-k.t+5,l:b.l-k.l+5,key:d,flag:c,textarea:g.textEl})},30)},hide:function(){e.style.display="none"},show:function(){e.style.display=""}}}(),o=function(){if(a.kit.dom.isTurnoff(g.textEl))clearInterval(h);else{var b=g.textEl.value.replace(/\r/g,""),c=f(g.textEl);if(c<0||c==j)return;j=c;var d=b.slice(0,c),e=d.match(new RegExp(["(",g.flag,")([a-zA-Z0-9一-龥_]{0,20})$"].join("")));if(!e){a.custEvent.fire(g.eId,"hidden");return}var i=b.slice(c);d=d.slice(0,-e[0].length);n.content(d,e[1],e[2],i)}};return function(b){if(!!b&&!!b.textEl){b=a.parseParam({textEl:null,flag:"@",eId:a.custEvent.define({},["at","hidden"])},b);var c=function(){if(!!g){clearInterval(h);a.removeEvent(g.textEl,"blur",c);n.hide()}},d=function(){c();g=b;j=null;n.bind();n.show();h=setInterval(o,200);a.addEvent(b.textEl,"blur",c)};a.addEvent(b.textEl,"focus",d);return b.eId}}});
STK.register("common.trans.editor",function(a){var b=location.host=="widget.weibo.com"||location.host=="dev.weibo.com"?"":"/widget",c=a.kit.io.inter(),d=c.register;d("face",{url:b+"/public/aj_getemotions.php"});d("at",{url:b+"/public/aj_atusers.php"});return c});
STK.register("module.suggest",function(a){var b=null,c=a.custEvent,d=c.define,e=c.fire,f=c.add,g=a.addEvent,h=a.removeEvent,i=a.stopEvent,j=[],k={},l={ENTER:13,ESC:27,UP:38,DOWN:40,TAB:9},m=function(b){var c=-1,j=[],k=b.textNode,m=b.uiNode,n=a.core.evt.delegatedEvent(m),o=d(k,["open","close","indexChange","onSelect","onIndexChange","onClose","onOpen","openSetFlag"]);o.setFlag=p;var p=function(a){b.flag=a},q=function(){return a.sizzle(["[action-type=",b.actionType,"]"].join(""),m)},r=function(){c=-1;h(k,"keydown",s);n.destroy()},s=function(a){var d,f;if(!!(d=a)&&!!(f=d.keyCode)){if(f==l.ENTER){i();e(o,"onSelect",[c,k,b.flag]);return!1}if(f==l.UP){i();var g=q().length;c=c<1?g-1:c-1;e(o,"onIndexChange",[c]);return!1}if(f==l.DOWN){i();var g=q().length;c=c==g-1?0:c+1;e(o,"onIndexChange",[c]);return!1}if(f==l.ESC){i();r();e(o,"onClose");return!1}if(f==l.TAB){r();e(o,"onClose");return!1}}},t=function(c){e(o,"onSelect",[a.core.arr.indexOf(c.el,q()),k,b.flag])},u=function(b){c=a.core.arr.indexOf(b.el,q());e(o,"onIndexChange",[a.core.arr.indexOf(b.el,q())])};f(o,"open",function(a,c){k=c;r();g(c,"keydown",s);n.add(b.actionType,"mouseover",u);n.add(b.actionType,"click",t);e(o,"onOpen",[b.flag])});f(o,"openSetFlag",function(a,b){p(b)});f(o,"close",function(){r();e(o,"onClose",[b.flag])});f(o,"indexChange",function(a,d){c=d;e(o,"onIndexChange",[c,b.flag])});return o},n=function(b){var c=b.textNode,d=a.core.arr.indexOf(c,j);if(!k[d]){j[d=j.length]=c;k[d]=m(b)}return k[d]};return function(c){if(!!c.textNode&&!!c.uiNode){c=a.parseParam({textNode:b,uiNode:b,actionType:"item",actionData:"index",flag:""},c);return n(c)}}});
STK.register("common.channel.at",function(a){var b=["open","close"];return a.common.listener.define("common.channel.at",b)});
STK.register("kit.dom.layoutPos",function(a){return function(b,c,d){if(!a.isNode(c))throw"kit.dom.layerOutElement need element as first parameter";if(c===document.body)return!1;if(!c.parentNode)return!1;if(c.style.display==="none")return!1;var e,f,g,h,i,j,k;e=a.parseParam({pos:"left-bottom",offsetX:0,offsetY:0},d);f=c;if(!f)return!1;while(f!==document.body){f=f.parentNode;if(f.style.display==="none")return!1;j=a.getStyle(f,"position");k=f.getAttribute("layout-shell");if(j==="absolute"||j==="fixed")break;if(k==="true"&&j==="relative")break}f.appendChild(b);g=a.position(c,{parent:f});h={w:c.offsetWidth,h:c.offsetHeight};i=e.pos.split("-");i[0]==="left"?b.style.left=g.l+e.offsetX+"px":i[0]==="right"?b.style.left=g.l+h.w+e.offsetX+"px":i[0]==="center"&&(b.style.left=g.l+h.w/2+e.offsetX+"px");i[1]==="top"?b.style.top=g.t+e.offsetY+"px":i[1]==="bottom"?b.style.top=g.t+h.h+e.offsetY+"px":i[1]==="middle"&&(b.style.top=g.t+h.h/2+e.offsetY+"px");return!0}});
STK.register("common.editor.plugin.at",function(a){var b=a.kit.extra.language,c='<div class="WB_tips_smart WB_email"><p class="tipsmt_title" node-type="suggestTitle">想用@提到谁</p><ul class="tipsmt_list" node-type="suggestWrap"></ul></div>',d={"@":{normalTitle:b("#L{选择昵称或轻敲空格完成输入}"),moreTitle:b("#L{选择最近@的人或直接输入}"),noTilte:b("#L{轻敲空格完成输入}")},"#":{normal:b("#L{想用什么话题？}")}},e={"@":'<#et temp data><#list data.data as list><li action-type="item" <#if (list_index == 0)>class="tipsmt_cur" </#if>action-data="value=${list.nickname}" value="${list.nickname}"><a href="#">${list.nickname}<#if (list.remark)>(${list.remark})</#if></a></li><#if (list.count)><span>${list.count}</span></#if></#list></#et>',"#":'<#et temp data><#list data.data as list><li action-type="item" <#if (list_index == 0)>class="cur" </#if>action-data="value=${list.topic}" value="${list.topic}"><a href="#">${list.topic}<#if (list.count)>(${list.count})</#if></a></li></#list></#et>'},f,g,h,i,j,k,l,m=!1,n,o,p={"@":"at","#":"topicList"},q=0,r=function(){setTimeout(function(){a.custEvent.fire(f,"close")},200)},s=function(){k.style.display="none"},t=function(){a.custEvent.add(f,"onIndexChange",function(a,b){y(b)});a.custEvent.add(f,"onSelect",function(b,c,d,e){q=0;a.core.evt.stopEvent();var g=o[c].getAttribute("value");g=g.replace(/\(.*\)/,"");try{d.focus()}catch(h){}var i=a.kit.extra.textareaUtils.selectionStart(d)*1,j=new RegExp(e+"([a-zA-Z0-9一-龥_]{0,20})$"),k=d.value.replace(/\r+/g,"").slice(0,i).match(j),l=d.value.slice(i,i+1);k=k&&k[1]?k[1].length:0;var m=a.kit.extra.textareaUtils;e=="#"?typeof l!="undefined"&&l!=e&&(g=g+e+" "):g=g+" ";m.insertText(d,g,i,k);var n=m.getCursorPos(d);if(e=="#"&&l==e){m.setCursor(d,n+1);m.insertText(d," ",n+1,0)}n=m.getCursorPos(d);var p=m.getSelectedText(d),r=p==""||p==null?0:p.length;d.setAttribute("range",n+"&"+r);a.custEvent.fire(f,"close")});a.addEvent(h.textEl,"blur",r);a.custEvent.add(f,"onClose",s);a.custEvent.add(f,"onOpen",function(b,c){j.style.display="";k.style.display="";m=!0;setTimeout(function(){a.custEvent.fire(f,"indexChange",0)},100)})},u=function(b,c,f){b=="@"?c.data&&c.data.length>0?c.title=f==""?d[b].moreTitle:d[b].normalTitle:c.title=d[b].noTilte:c.title=d[b].normalTitle;var g=a.core.util.easyTemplate(e[b],c);return g},v=function(){a.core.evt.custEvent.add(g,"hidden",function(b,c){a.custEvent.fire(f,"close")});a.core.evt.custEvent.add(g,"at",function(b,c){l=c.key;var e=c.flag;if(l.length==0&&e!="@")a.custEvent.fire(f,"close");else{var g=document.location.host=="widget.weibo.com"?"":"/widget";a.core.io.ajax({url:g+"/public/aj_atusers.php",args:{wsrc:$CONFIG.wsrc||"app_comment_box",appkey:$CONFIG.source_appkey||$CONFIG.appkey||$CONFIG.app_src,q:l},onComplete:function(b){if(b.code=="100000"){var g=u(e,b,l);a.custEvent.fire(f,"openSetFlag",e);a.custEvent.fire(f,"open",c.textarea);var h=a.core.dom.builder(g),m=h.box;j.innerHTML=m;j.style.display=b.data.length==0?"none":"";i.innerHTML=l.length==0?d["@"].moreTitle:d["@"].normalTitle;k.style.cssText=["z-index:11001;background-color:#ffffff;position:absolute;"].join("");a.common.channel.at.fire("open");a.kit.dom.layoutPos(k,c.textarea,{pos:"left-top",offsetX:c.l,offsetY:c.t})}else a.custEvent.fire(f,"close")},onFail:function(){a.custEvent.fire(f,"close")}})}})},w=function(){n=h.textEl;g=STK.module.at({textEl:n,flag:"@"})},x=function(b){q=0;k&&(k.style.display="none");k&&(k.innerHTML="");var d=a.builder(c);k=a.kit.dom.firstChild(d.box);k.style.display="none";document.body.appendChild(k);i=d.list.suggestTitle[0];j=d.list.suggestWrap[0];f&&a.custEvent.fire(f,"close");f&&a.custEvent.remove(f);f=a.module.suggest({textNode:b,uiNode:j,actionType:"item",actionData:"value",flag:"@"});t()},y=function(b){o=a.sizzle("li",j);o&&o[0]&&a.core.dom.removeClassName(o[q],"tipsmt_cur");a.core.dom.addClassName(o[b],"tipsmt_cur");q=b};return function(a,b){h=a.nodeList;var c={};c.init=function(){w();x(h.textEl);v()};return c}});
STK.register("common.editor.simpleEditor",function(a){var b=a.core.str.trim,c,d=a.common.editor.getLength,e=function(a,b){var c=d(a),e=Math.abs(b-c),f;c>b||c<1?f={wordsnum:c,vnum:e,overflow:!0}:c==0?f={wordsnum:c,vnum:e,overflow:!0}:f={wordsnum:c,vnum:e,overflow:!1};return f};return function(d,f){f=f||{};var g=f.limit||140;if(!d)throw"[easyEditor]: editor is null";a.custEvent.define(d,"textNum");a.custEvent.define(d,"keyUpCount");var h=a.sizzle('[node-type="editor"]',d)[0],i=a.sizzle('[node-type="wordNum"]',d)[0];if(f.atSwitch!=null&&f.atSwitch==!0){var j=a.common.editor.plugin.at({nodeList:{textEl:h}},f);j.init()}a.addEvent(h,"focus",function(){c=setInterval(function(){k()},200)});a.addEvent(h,"blur",function(){c&&clearInterval(c)});var k=function(){var c=b(h.value).length==0?b(h.value):h.value;c=c.replace(/\r\n/g,"\n");var j=e(c,g);c.length>=0&&h.focus?j.overflow&&j.wordsnum!=0?i.className=f.warnClassName?f.warnClassName:"WB_tipS_numWarn":i.className=f.className?f.className:"WB_tipS_num":c.length===0&&(i.className=f.className?f.className:"WB_tipS_num");c.length!==0&&j.overflow?i.innerHTML="-"+(j.vnum>100?"n":j.vnum):i.innerHTML=j.vnum;a.custEvent.fire(d,"textNum",{count:j.wordsnum,isOver:j.overflow})};a.addEvent(h,"keyup",k);a.custEvent.add(d,"keyUpCount",k);k()}});
STK.register("common.editor.flashContent",function(a){return function(a,b,c,d){b=b||["#fee","#fdd","#fcc","#fdd","#fee","transparent"];c=c||2;d=d||50;var e=0,f=b.length,g=c*f,h=setInterval(function(){a.style.backgroundColor=b[e%f];e++;e==g&&clearInterval(h)},d)}});
STK.register("comp.widget.list.showEditor",function(a){var b=a.kit.extra.language,c=a.addEvent,d=a.common.editor.getLength,e=a.common.editor.flashContent,f=a.removeEvent,g={focus:!0,needLengthJudge:!0,judgeLength:!0,type:"repost",template:'<#et temp data><div class="liveStream_mainFeed_list_comment" style="display:block;" node-type="outer"><div class="liveStream_mainFeed_listArrow W_bgcolor_arrow" style="margin-right:47px;" node-type="arrow"><em class="liveStream_mainFeed_listArrowArrline">◆</em><span>◆</span></div><div class="liveStream_mainFeed_list_commentInput" node-type="publisher"><div class="commentInput_area"><textarea class="WB_textarea" node-type="editor">${data.text}</textarea><p class="commentInput_state" style="display:none;" node-type="error"><span class="WB_tipS_err commentInput_state_icon"></span><span node-type="tip_error">#L{发表微博失败}</span><a href="###" node-type="back">#L{返回}</a></p><p class="commentInput_state" style="display:none;" node-type="success"><span class="WB_tipS_ok commentInput_state_icon"></span><span node-type="tip_success">#L{发布成功}</span></p></div><div class="commentInput_action clearfix"><div class="commentInput_actionRetweet"><p class="commentInput_actionRe"><input type="checkbox" node-type="check" id="checkIt" /><label for="checkIt" node-type="more">#L{同时评论}</label></p></div><div class="commentInput_actionButton"><p class="commentInput_actionSub"><a href="###" class="WB_btnA" node-type="sendBtn"><span>#L{转发}</span></a></p><p class="commentInput_actionFont"><span class="txt_num" node-type="wordNum">140</span>#L{字}</p></div></div></div></div></#et>',forward:"",uname:"",callback:function(){}};return function(h,i){var j,k,l,m={},n="";g=a.parseParam(g,i);if(h&&typeof h=="string")h=a.E(h);else if(h.nodeType!==1)throw"[common.widget.showEditor] node.nodeType wrong!";var o={text:""};if(g.type==="repost"){g.uname=decodeURIComponent(g.uname);var p;g.judgeLength?p=g.forward?"//@"+g.uname+"："+decodeURIComponent(g.forward||""):"":p=decodeURIComponent(g.forward||"");o.text=p}var q=function(c){g=a.parseParam(g,c);if(g.type==="comment"){l.more.innerHTML=b("#L{同时转发}");l.sendBtn.innerHTML=b("<span>#L{评论}</span>");l.editor.value=decodeURIComponent(g.forward)}},r=function(){var b=a.trim(l.editor.value),c=d(b);if(g.judgeLength)if(c>140||c===0&&g.needLengthJudge){e(l.editor);return!1}var f=l.check.checked;typeof g.callback=="function"&&g.callback.call(m,b,f)},s=function(){u();v();t()},t=function(){h.parentNode.appendChild(k.box);l=a.kit.dom.parseDOM(a.builder(h.parentNode).list);g.focus&&a.kit.extra.textareaUtils.setCursor(l.editor,0,0);a.common.editor.simpleEditor(l.publisher,{warnClassName:"txt_num S_error",className:"txt_num"})},u=function(){j=a.core.util.easyTemplate(b(g.template),o).toString();k=a.core.dom.builder(j);l=a.kit.dom.parseDOM(k.list)},v=function(){if(g.type==="comment"){l.more.innerHTML=b("#L{同时转发}");l.sendBtn.innerHTML=b("<span>#L{评论}</span>")}c(l.back,"click",w);c(l.sendBtn,"click",r);a.core.evt.hotKey.add(l.editor,"ctrl+Enter",r)},w=function(){l.error.style.display="none";l.editor.value=n};m.showError=function(a){a&&(l.tip_error.innerHTML=a);l.error.style.display="";n=l.editor.value;l.editor.value="";setTimeout(function(){l&&(l.error.style.display="none")},3e3)};m.clear=function(){n="";l.editor.value=""};m.showSuccess=function(a){a&&(l.tip_success.innerHTML=a);m.clear();l.success.style.display="";setTimeout(function(){l&&(l.success.style.display="none")},3e3)};m.setArrow=function(a){l.arrow.style.marginRight=a+"px"};m.getNodes=function(){return l};m.show=t;m.hide=function(a){if(!!l){l.outer.style.display="none";a&&this.destroy()}};m.focus=function(b){a.kit.extra.textareaUtils.setCursor(l.editor,b,0)};m.destroy=function(){f(l.back,"click",w);f(l.sendBtn,"click",r);a.core.evt.hotKey.remove(l.editor,"ctrl+Enter",r);a.removeNode(l.outer);for(var b in l)l[b]=null;l=null};s();m.reInit=q;m.pubNodes=l;return m}});
STK.register("template.widget.list",function(a){return function(){var a={},b='<#et temp data><li action-type="outer"  class="expand_item S_separate" node-type="reply_outer"><div class="user_avatar_container"><a class="user_avatar_link" target="_blank" href="http://weibo.com/${data.userinfo.id}" title=""><img width="30" height="30" class="user_avatar" src="${data.userinfo.profile_image_url}" alt=""></a></div><div class="expand_content"><div class="expand_text"><a title="" target="_blank" href="http://weibo.com/${data.userinfo.id}" class="user_name">${data.userinfo.screen_name}</a><cite class="user_words">：${data.content}</cite></div><div class="expand_bottom"><div class="expand_bottom_handle"><a action-data="mid=${data.mid}&amp;name=${data.userinfo.screen_name}&amp;cid=${data.cid}" action-type="reply" title="" href="#0" class="reply_link">回复</a></div></div></div></li></#et>',c='<#et temp data><div class="expand_list_container"><ul class="expand_list"></ul></div></#et>',d='<div class="WB_widget WB_tips_top" style="top:100px;left:600px;"><div class="tips_inner"><cite class="WB_tipS_warn"></cite><cite class="WB_icon_txt">您的帐号尚未开通微博<a class="WB_tipS_link" title="" href="#0">立即开通</a></cite></div><div class="tips_arr" style="right:30px;"></div><a class="WB_tips_close" title="" href="#0"></a></div>',e='<u class="status_icon status_alert"></u>加载失败，请<a class="loading_inform_a" title=""  action-data="type=all" href="#0" title="" action-type="more">重试</a>',f='<#et temp data><div class="login_container"><cite class="WB_vline">|</cite><a class="logout_link" href="http://weibo.com/logout.php?backurl=${data.backurl}" title="">退出</a></div><div class="top_part_title">${data.listname}</div><div class="login_link_container"><div class="login_link_inside"><u class="status_icon status_logo"></u><a class="login_link" title="${data.nick}" target="_blank" href="http://weibo.com/${data.uid}">${data.nick}</a></div></div></#et>',g='<#et temp data><div class="login_container"><cite class="WB_vline">|</cite><a class="logout_link" node-type="login" href="javascript:;" title="">登录</a></div><div class="top_part_title">${data.listname}</div><div class="login_link_container"><div class="login_link_inside"><u class="status_icon status_logo"></u><a class="login_link" target="_blank" href="http://weibo.com/signup/signup.php?from=zw&amp;appsrc=1JreRx&amp;backurl=http%3A%2F%2Fweibo.com&amp;vsrc=app_listweibo&amp;showlogo=0">注册</a></div></div></#et>',h='<#et temp data> <div class="handle_expand S_border S_bg_title" node-type="outer"> <div class="expand_arrow"  node-type="arrow"><cite class="expand_arrow_border S_border_c">◆</cite><cite class="expand_arrow_content S_bg_title_c">◆</cite></div><div class="expand_container"  node-type="publisher"><div class="input_container"><div class="expand_textarea_container"><textarea class="expand_textarea"  node-type="editor">${data.text}</textarea><div class="textarea_note" style="display:none;" node-type="error"><u class="WB_tipS_err"></u><cite class="textarea_note_text"   node-type="tip_error" >评论失败，请重试！</cite><span node-type="back"></span></div><div class="textarea_note" style="display:none;"  node-type="success" ><u class="WB_tipS_ok"></u><cite class="textarea_note_text"  node-type="tip_success">评论成功</cite></div></div><div class="input_submit"><div class="input_media"><label class="input_form_plus"><input type="checkbox" checked class="WB_checkbox2" node-type="check" id="check_id"/><span node-type="more">同时评论</span></label></div><div class="submit_btn_container"><cite class="weibo_count"  node-type="wordNum">140</cite><a class="submit_btn WB_red_btn" href="#0" title=""><cite class="WB_red_btn_inner"  node-type="sendBtn">转发</cite></a></div></div></div><div node-type="commentList"></div></div></div></#et>';a.commentTemplate=h;a.loadingFailTemplate=e;a.commentListTemplate=b;a.linkTemplate=c;a.loginedTitleTemplate=f;a.unLoginTitleTemplate=g;return a}});
STK.register("comp.widget.list.publish",function(a){var b=a.kit.extra.language,c=a.common.trans.list,d=a.core.util.listener,e=$CONFIG.$language?$CONFIG.$language:"zh_cn",f,g=a.core.evt.custEvent,h,i='<#et temp msg><span class="WB_tipS_ok commentInput_state_icon"></span>${data.msg}</#et>',j='<#et temp data><span class="WB_tipS_err commentInput_state_icon"></span>${data.msg}<a href="javascript:;" action-type="back">返回</a></#et>';return function(h,i){var j=a.comp.widget.list.showEditor,k,l,m,n,o,p=!1,q=!1,r,s=!1,t,u={},v=a.template.widget.list(),w,x,t=v.commentTemplate,y=a.common.widget.login({vsrc:"app_listweibo",appsrc:scope.$appsrc||"",callback:function(){a.comp.widget.list.login(D.loginComplete)}}),z=function(){A();B()},A=function(){if(!h)throw"no available node found"},B=function(){g.define(D,"editorShow")},C=function(){},D={showEditor:function(b,c){s=$CONFIG.$tip=="1"?!0:!1;var d=b.data,e=!0,p=c==="repost"?d.retweeted_urltext:"";c=="repost"&&d.retweeted_urltext.length<=0&&(e=!1);r=a.kit.dom.parentElementBy(b.el,h,function(a){if(a.getAttribute("mid")==d.mid)return!0});var u=a.kit.dom.firstChild(r);if(a.isNode(f)){a.removeClassName(f,"weiboList_mainFeed_list_focus");f.removeAttribute("current")}if(r&&u){f=r;a.addClassName(r,"weiboList_mainFeed_list_focus");r.setAttribute("current",!0)}l=r.getAttribute("mid");m=r.getAttribute("uid");var v={focus:!1,needLengthJudge:c=="repost"?!1:!0,template:t,uname:d.username,type:c,callback:function(a,e){d.text=a;d.check=e;d.type=c;D.send(b.el,d)},forward:p,judgeLength:e};if(o==c){if(q){if(n==l){k&&k.hide&&k.hide(!0);a.removeClassName(r,"weiboList_mainFeed_list_focus");q=!1;g.fire(D,"editorShow",{last:!1,target:null});return}k&&k.hide&&k.hide(!0)}}else k&&k.hide&&k.hide(!0);o=c;n=l;k=j(u,v);var w=a.position(b.el),x=a.core.dom.getSize(b.el),y=a.position(r),z=a.core.dom.getSize(r),A=z.width-x.width/2-(w.l-y.l)-15;k.setArrow(A);setTimeout(function(){k&&k.focus&&k.focus(0)},200);var B={last:!1,target:k},C=a.core.dom.position(i);i.offsetHeight+C.t-w.t<=110&&(B.last=!0);q=!0;D.getCommentList(l,c)},getCommentList:function(a,b){var d=b=="repost"?"allreposts":"allcomments",e=c.getTrans(d,{onComplete:function(a,b){if(a.code=="100000"||a.code=="A00006"){k.pubNodes.commentList.innerHTML=a.data;g.fire(D,"editorShow",opt)}},onFail:function(){g.fire(D,"editorShow",opt)}});e.request({wsrc:$CONFIG.wsrc||"app_list",mid:a,language:$CONFIG.$language,html_type:2,app_src:$CONFIG.$appsrc,output:2})},send:function(a,d){var e=null,f=null;p=d.check?"1":"0";if(d.type=="comment"){e=D.comment(d);f=D.commentCbk}else if(d.type=="repost"){e=D.repost(d);f=D.repostCbk}if(s&&scope.$isLogin())window.open("http://weibo.com/signup/full_info.php?appsrc=1JreRx&showlogo=0&backurl="+encodeURIComponent(document.URL)+"&nonick=1&lang=zh-cn&callback=http%3A%2F%2Fweibo.com&vsrc=weibolist","open","width=950,height=620");else{if(e==null)return;var g=d.type=="repost"?"repostmblog":"addcomment",h=c.getTrans(g,{onComplete:function(a,c){var d="";if(a.code=="A00006"||a.code=="100000")f&&f(a,c);else{d=a.msg||$SYSLANG[a.code]||"发微博失败，请稍后再试！";k.showError(b("#L{"+d+"}"))}},onFail:function(){k.showError(b("#L{请求失败，请稍候再试}"))}});if(!scope.$isLogin()){y.showLogin();w=h;x=e;return}h.request(e)}},repost:function(a){var b=a.text;if(a.retweeted_urltext.length<=0&&b.length<=0||b.length<=0)b="转发微博";var c={app_src:scope.$appsrc,and:p,content:b,restitle:decodeURIComponent(a.urltext),srcid:a.mid,srcuid:a.srcuid,uid:scope.$oid,language:e,listid:scope.$listid,refer:encodeURIComponent(document.referrer),wsrc:$CONFIG.wsrc||"app_list"};return c},comment:function(a){var b={mid:r.getAttribute("mid"),is_repost:p,content:a.text,language:e,appkey:scope.$appkey,refer:encodeURIComponent(document.referrer),listid:scope.$listid,url:encodeURIComponent(document.referrer),vsrc:"list_5551",wsrc:$CONFIG.wsrc||"app_list"};return b},reply:function(d){var e=d.data,f="回复@"+e.name+":",g=c.getTrans("addcomment",{onComplete:function(c,d){var e="";if(c.code=="A00006"||c.code=="100000"){e="回复成功";var f=c.data;if(f){var g=a.core.util.easyTemplate(b(v.commentListTemplate),f),h=a.builder(g),i=k.pubNodes.commentList.getElementsByTagName("ul")[0];i&&a.core.dom.insertHTML(a.kit.dom.firstChild(i),g,"beforebegin")}k.showSuccess(e);E(el)}else{e=c.msg||$SYSLANG[c.code]||"发微博失败，请稍后再试！";k.showError(b("#L{"+e+"}"))}},onFail:function(){k.showError(b("#L{请求失败，请稍候再试}"))}}),h={focus:!1,template:t,uname:e.username,type:"comment",callback:function(a,b){if(s&&scope.$isLogin())window.open("http://weibo.com/signup/full_info.php?appsrc=1JreRx&showlogo=0&backurl="+encodeURIComponent(document.URL)+"&nonick=1&lang=zh-cn&callback=http%3A%2F%2Fweibo.com&vsrc=weibolist","login","width=950,height=620");else{var c={mid:r.getAttribute("mid"),content:a,cid:d.data.cid,appkey:$CONFIG.$appkey,is_repost:b?"1":"0",language:$CONFIG.$language,refer:encodeURIComponent(document.referrer),listid:scope.$listid,url:encodeURIComponent(document.referrer),vsrc:"list_5551",wsrc:$CONFIG.wsrc||"app_list"};g.request(c)}},forward:f};if(k!=null){k.reInit(h);k.focus(f.length)}},focus:function(a){k.focus(a)},repostCbk:function(c,d){var e="转发成功",f=c.data;if(f){var g=k.pubNodes.commentList.getElementsByTagName("ul")[0];if(g==null){var h=a.core.util.easyTemplate(b(v.commentListTemplate),f),i=a.core.util.easyTemplate(b(v.linkTemplate),f);k.pubNodes.commentList.innerHTML+=i;var g=k.pubNodes.commentList.getElementsByTagName("ul")[0];g.innerHTML=h}else{var h=a.core.util.easyTemplate(b(v.commentListTemplate),f);k.pubNodes.commentList.innerHTML+=h}}k.showSuccess(e);E(el);x=null;w=null},commentCbk:function(c,d){var e="评论成功",f=c.data,g=k.pubNodes.commentList.getElementsByTagName("ul")[0];if(g==null){var h=a.core.util.easyTemplate(b(v.commentListTemplate),f),i=a.core.util.easyTemplate(b(v.linkTemplate),f);k.pubNodes.commentList.innerHTML+=i;var g=k.pubNodes.commentList.getElementsByTagName("ul")[0];g.innerHTML=h}else{var i=a.core.util.easyTemplate(b(v.commentListTemplate),f);g.innerHTML+=i}k.showSuccess(e);E(el);x=null;w=null},loginComplete:function(){d.fire("login","login",[""]);x!=null&&w!=null&&w.request(x)}},E=function(a){var b=a.innerHTML;/\((\d+)\)/.test(b)?b=b.replace(/(\d+)/,+RegExp.$1+1):b+="(1)";a.innerHTML=b};z();u=D;return u}});
STK.register("comp.widget.list.styleDiy",function(a){var b=function(b){var c=document.createElement("style");c.type="text/css";if(a.IE)c.styleSheet.cssText=b;else{var d=document.createDocumentFragment();d.appendChild(document.createTextNode(b));c.appendChild(d)}document.getElementsByTagName("head")[0].appendChild(c)},c=a.core.dom.getSize,d="diycss";return function(c,e){var f=!1,g=location.href,h=a.core.util.URL(g),i=h.getParam("color")||"",j=function(){var b=document.createElement("link");b.rel="stylesheet";b.type="text/css";b.href="http://img.t.sinajs.cn/t4/appstyle/widget/css/weiboList/skin/new_skin00_diy.css";document.getElementsByTagName("head")[0].appendChild(b);a.E(d)&&a.removeNode(a.E(d))};if(i){j();i=i.split(",");var k=[],l="";if(i[0]){k.push(".WB_widget .S_border{border-color:#"+i[0]+";}\n");k.push(".WB_widget .S_border_c{color:#"+i[0]+";}\n");k.push(".WB_widget .S_border_bg{background-color:#"+i[0]+";}\n")}if(i[1]){k.push(".WB_widget .S_bg_title{ background-color:#"+i[1]+";}\n");k.push(".WB_widget .S_bg_title_c{color:#"+i[1]+";}\n")}if(i[2]){k.push(".WB_widget{ color:#"+i[2]+";}\n");k.push(".WB_pages_minibtn .current{ color:#"+i[2]+" !important;}\n")}if(i[3]){k.push(".WB_widget a{ color:#"+i[3]+"  !important; }\n");k.push(".WB_widget .select_current .S_link_bg,.WB_widget .select_current .S_link_bg:hover{ background-color:#"+i[3]+" !important; }\n")}i[4]&&k.push(".WB_widget .S_bg{ background:#"+i[4]+";}\n");i[5]&&k.push(".WB_widget .S_bg_hover{background-color: #"+i[5]+";}\n");l=k.join("");b(l)}var m=/isborder=(\d+)/.test(g)?RegExp.$1:1;m!=0;if(!!c.feed){var n=parseInt(height-titlebar-developer-tabs-3);mainBox.style.height=n+"px"}}});
STK.register("common.widget.scroll",function(a){var b=a.core.evt.addEvent,c=function(a){if(!a||!a.preventDefault){window.event.returnValue=!1;return!1}a.preventDefault();a.stopPropagation()};return function(c){var d={},e,f,g,h,i,j,k,l,m,n,o={outer:null,inner:null,itemHeight:10,button:!1,buttonElm:{lastBtn:null,nextBtn:null},handler:{upCallBack:null,downCallBack:null,touchTop:null,touchBottom:null}};o=a.parseParam(o,c);var p=function(a){if(!(a>0&&o.inner.offsetTop-g>=0)){if(a<0&&o.inner.offsetTop-g-(o.outer.offsetHeight-o.inner.offsetHeight)<o.itemHeight){l=o.inner.offsetTop-g-(o.outer.offsetHeight-o.inner.offsetHeight);o.inner.style.marginTop=o.inner.offsetTop+l*a-g+"px";if(q.loadingMutex)return}else if(a>0&&Math.abs(o.inner.offsetTop-g)<o.itemHeight){l=Math.abs(o.inner.offsetTop-g);o.inner.style.marginTop=o.inner.offsetTop+l*a-g+"px";o.handler&&o.handler.touchTop&&o.handler.touchTop();h!=null&&(h.style.display="none")}else{var b=o.inner.offsetTop+o.itemHeight*a-g+"px";o.inner.style.marginTop=o.inner.offsetTop+o.itemHeight*a-g+"px";h!=null&&i!=null&&(i.style.display=h.style.display="block")}if(a>0&&Math.abs(o.inner.offsetTop-g)<o.itemHeight){h!=null&&(h.style.display="none");clearTimeout(m);clearInterval(n)}if(a<0&&o.inner.offsetTop-g-(o.outer.offsetHeight-o.inner.offsetHeight)<o.itemHeight){i!=null&&(i.style.display="none");o.handler&&o.handler.touchBottom&&o.handler.touchBottom();clearTimeout(m);clearInterval(n)}}},q={loadingMutex:!1,init:function(){if(o.button){h=o.buttonElm.lastBtn;i=o.buttonElm.nextBtn;h.style.display="none";i.style.display="";b(h,"click",q.lastButtonClickHandler);b(i,"click",q.nextButtonClickHandler);b(h,"mousedown",q.lastMouseDown);b(i,"mousedown",q.nextMouseDown);b(h,"mouseup",q.mouseUp);b(i,"mouseup",q.mouseUp)}e=o.outer.offsetHeight;f=o.inner.offsetHeight;g=o.inner.offsetTop},mouseover:function(a){document.attachEvent&&o.outer.attachEvent("onmousewheel",q.scroll);if(document.addEventListener){o.outer.addEventListener("mousewheel",q.scroll,!1);o.outer.addEventListener("DOMMouseScroll",q.scroll,!1)}},mouseout:function(a){document.attachEvent&&o.outer.detachEvent("onmousewheel",q.scroll);if(document.addEventListener){o.outer.removeEventListener("mousewheel",q.scroll,!1);o.outer.removeEventListener("DOMMouseScroll",q.scroll,!1)}},scroll:function(b){a.core.evt.stopEvent(b);var c=null,d=b.wheelDelta/120||b.detail/-3,e;p(d)},lastButtonClickHandler:function(a){var b=1;p(b)},nextButtonClickHandler:function(a){var b=-1;p(b)},destroy:function(){q.mouseout()},reset:function(){i.style.display="none"},lastMouseDown:function(a){var a=a||window.event,b=a.target||a.srcElement;m=setTimeout(function(){n=setInterval(function(){p(1)},50)},500)},nextMouseDown:function(a){var a=a||window.event,b=a.target||a.srcElement;m=setTimeout(function(){n=setInterval(function(){p(-1)},50)},500)},mouseUp:function(a){n!=null&&clearInterval(n);m!=null&&clearTimeout(m)}},r=function(){if(o.outer==null||o.inner==null)throw"node is not defined"},s=function(){b(o.inner,"mouseover",q.mouseover)},t=function(){if(o.inner.offsetHeight<=o.outer.offsetHeight){o.buttonElm.lastBtn.style.display="none";o.buttonElm.nextBtn.style.display="none"}else q.init()},u=function(){r();t();s()};u();d=q;return d}});
STK.register("comp.widget.list.feedList",function(a){var b=a.kit.extra.language,c=a.core.evt.custEvent,d=a.core.util.listener,e='<div class="loading_inform"><u class="WB_ico_loadingD"></u>加载信息</div>',f='<li class="select_item select_current" action-type="icon"><a class="select_item_a S_bg_hover S_link_bg" title="" href="#0"><img class="select_item_a_img" width="30" height="30" src="http://img.t.sinajs.cn/t4/appstyle/widget/images/weiboList/select_all_img.jpg "></a></li>';return function(g,h){var i=[/^http:\/\/widget.weibo.com/,/^http:\/\/service.t.sina.com.cn/,/^http:\/\/service.weibo.com/],j=["http://widget.weibo.com/public/publishmblog.php?ac=add_mblog&callback=listclose","http://service.t.sina.com.cn/widget/public/publishmblog.php?ac=add_mblog&callback=listclose","http://service.weibo.com/widget/public/publishmblog.php?ac=add_mblog&callback=listclose"],k={},l,m,n=0,o=0,p=!1,q=$CONFIG.$language?$CONFIG.$language:"zh_cn",r=a.common.trans.list,s=a.comp.widget.list.follow(),t=a.common.widget.login({vsrc:"app_listweibo",appsrc:scope.$appsrc||"",callback:function(){a.comp.widget.list.login();d.fire("login","login",[""])}}),u,v,w,x,y,z={},A,B=!1,C=!1,D=1,E,F,G,H,I,J,K=!0,L,M,N=!1,O=0,P,Q={hasload:!1,init:function(b){if(Q.hasload){if(b){I.style.display="";a.core.dom.removeClassName(J,"switch_off");a.core.dom.addClassName(J,"switch_on")}else{I.style.display="none";a.core.dom.removeClassName(J,"switch_on");a.core.dom.addClassName(J,"switch_off")}J.style.display="block";l.icon_list.style.marginTop="0px";a.addEvent(J,"click",Q.asideShow);x=a.common.widget.scroll({outer:I,inner:l.icon_list,itemHeight:10,button:!0,buttonElm:{lastBtn:l.prev_btn,nextBtn:l.next_btn},handler:{touchBottom:Q.touchBottom}})}var c=r.getTrans("portrait",{onComplete:function(b){if(b.code=="A00006"||b.code=="100000"){l.icon_list.innerHTML=f+b.data;M=l.icon_list.getElementsByTagName("li")[0];L=M;P=b.next_cursor;Q.hasload=!0;x=a.common.widget.scroll({outer:I,inner:l.icon_list,itemHeight:10,button:!0,buttonElm:{lastBtn:l.prev_btn,nextBtn:l.next_btn},handler:{touchBottom:Q.touchBottom}})}},onFail:function(a){}});c.request({app_src:scope.$appsrc,listid:scope.$listid,uid:scope.$oid,cursor:O,language:scope.$language,member_type:"left",refer:encodeURIComponent(document.referrer)});if(b){I.style.display="";a.core.dom.removeClassName(J,"switch_off");a.core.dom.addClassName(J,"switch_on")}else{I.style.display="none";a.core.dom.removeClassName(J,"switch_on");a.core.dom.addClassName(J,"switch_off")}J.style.display="block";l.icon_list.style.marginTop="0px";a.addEvent(J,"click",Q.asideShow)},asideShow:function(b){if(K){I.style.display="none";a.core.dom.removeClassName(J,"switch_on");a.core.dom.addClassName(J,"switch_off");K=!1}else{I.style.display="";a.core.dom.removeClassName(J,"switch_off");a.core.dom.addClassName(J,"switch_on");setTimeout(function(){x=a.common.widget.scroll({outer:I,inner:l.icon_list,itemHeight:10,button:!0,buttonElm:{lastBtn:l.prev_btn,nextBtn:l.next_btn},handler:{touchBottom:Q.touchBottom}})},200);K=!0}},iconClick:function(b){if(!B){B=!0;var c=b.el,d,e=a.kit.dom.parseDOM(a.builder(H).list);E=e.more_feed;d=H.getElementsByTagName("ul")[0];if(b.data.uid==null){if(z.all==null){B=!1;return}E&&o<=1&&(E.style.display="block");L!=null&&a.core.dom.removeClassName(L,"select_current");a.core.dom.addClassName(c,"select_current");L=c;d.innerHTML=z.all;w!=null&&w.rebuildScroll();B=!1;return}H.style.marginTop="0px";z.all==null&&(z.all=d.innerHTML);E&&(E.style.display="none");L!=null&&a.core.dom.removeClassName(L,"select_current");a.core.dom.addClassName(c,"select_current");L=c;if(z[b.data.uid]!=null){d.innerHTML=z[b.data.uid];w!=null&&w.rebuildScroll();B=!1}else V.getMemberFeed(b)}},touchBottom:function(){if(!C){C=!0;var a=I.getElementsByTagName("ul")[0],b=r.getTrans("portrait",{onComplete:function(a,b){P=a.next_cursor;var c=I.getElementsByTagName("ul")[0],d=a.data;c.innerHTML+=d;x.reset();C=!1},onFail:function(a,b){C=!1}});if(P==0){C=!1;return}b.request({member_type:"left",app_src:scope.$appsrc,listid:scope.$listid,uid:scope.$oid,cursor:P,language:scope.$language,refer:encodeURIComponent(document.referrer)})}}},R=function(){S();T();W();U()},S=function(){l=a.kit.dom.parseDOM(a.core.dom.builder(g).list);v=l.picshow;G=l.main_container;H=l.feed_container;scrollContainer=l.scroll_container;scrollBar=l.scroll_bar;I=l.aside_part;J=l.aside_switch},T=function(){m=a.core.evt.delegatedEvent(g);m.add("follow","click",s.add);m.add("more","click",V.getNewFeed);m.add("repost","click",V.repost);m.add("comment","click",V.comment);m.add("showpic","mouseover",V.showPic);m.add("showpic","mouseout",V.hidePic);m.add("icon","click",Q.iconClick);m.add("reply","click",V.reply);m.add("at","click",V.atMember);if(a.core.util.browser.IE6){m.add("feeditem","mouseover",V.mouseover);m.add("feeditem","mouseout",V.mouseout);m.add("memberitem","mouseover",V.mouseover);m.add("memberitem","mouseout",V.mouseout)}a.addEvent(l.login,"click",t.showLogin);l.tip_close&&a.core.evt.addEvent(l.tip_close,"click",function(a){l.tip_container.style.display="none"})},U=function(){w&&c.add(u,"editorShow",w.reset)},V={chgTabs:function(c){if(c.index===0){l.feed.style.display="";l.member.style.display="none"}else{if(!scope.$isLogin()){a.core.dom.prev(c.tabNode).className="current";c.tabNode.className="";t.showLogin();return}l.feed.style.display="none";l.member.style.display="";l.member.innerHTML="<span>"+b("#L{加载中...}")+"</span>";V.getMembers()}},turnPage:function(a){var b=a.data.cursor||0,c=a.data.type;c=="next"&&b==0||c=="prev"&&n==0||V.getMembers(b)},getMembers:function(a){a=a||0;n=a;var c=r.getTrans("getmember",{onComplete:function(a,b){l.member.innerHTML=a.data},onFail:function(){l.member.innerHTML=b("#L{请求失败，请稍候再试}")}});c.request({app_src:scope.$appsrc,listid:scope.$listid,uid:scope.$oid,cursor:a||0,language:q,refer:encodeURIComponent(document.referrer)})},getNewFeed:function(c){if(!p){p=!0;var d=a.kit.dom.parseDOM(a.builder(H).list);E=d.more_feed;var e=r.getTrans("getnewmblog",{onComplete:function(c,d){if(c.code=="A00006"&&c.data&&c.data.html){var e=a.builder(c.data.html),f=H.getElementsByTagName("ul")[0];f.innerHTML+=c.data.html;z.all=f.innerHTML;scope.$feedInfo.max_id=c.data.max_id;if(c.data.count<20||o>=1)E.style.display="none";o++;w!=null&&w.reset()}c.data?p=!1:E.innerHTML=b(listTemplate.loadingFailTemplate)},onFail:function(){E.innerHTML=b(listTemplate.loadingFailTemplate)}});e.request({app_src:scope.$appsrc,listid:scope.$listid,uid:scope.$oid,max_id:scope.$feedInfo.max_id||"",language:q})}},getMemberFeed:function(a){if(!p){p=!0;var c=H.getElementsByTagName("ul")[0];c.innerHTML="<li>"+e+"</li>";var d=r.getTrans("memberfeed",{onComplete:function(b,c){if(b.code=="A00006"&&b.data){var d=b.data,e=H.getElementsByTagName("ul")[0];z[a.data.uid]=d;e.innerHTML=d;w!=null&&w.rebuildScroll();B=!1}p=!1},onFail:function(){a.el.innerHTML=b("#L{请求失败，请稍候再试}")}});d.request({uid:a.data.uid,listuid:$CONFIG.$oid,language:scope.$language,listid:$CONFIG.$listid,app_src:scope.$appsrc,refer:encodeURIComponent(document.referrer)})}},showPic:function(b){var c=b.el,d=b.data.src,e=new Image;e.onload=function(){var b=l.feed.offsetWidth,d=a.position(c),f=d.l;parseInt(f+e.width)>b&&(f=b-e.width-2);v.style.left=f+"px";v.style.top=d.t+c.offsetHeight+2+"px";v.style.display="block"};e.src=d;v.appendChild(e)},hidePic:function(a){v.style.display="none";v.innerHTML=""},repost:function(a){u.showEditor(a,"repost")},comment:function(a){u.showEditor(a,"comment")},mouseover:function(b){b.el.getAttribute("current")||a.addClassName(b.el,"weiboList_mainFeed_list_focus")},mouseout:function(b){b.el.getAttribute("current")||a.removeClassName(b.el,"weiboList_mainFeed_list_focus")},memberover:function(b){a.addClassName(b.el,"weiboList_main_allList_focus")},memberout:function(b){a.removeClassName(b.el,"weiboList_main_allList_focus")},reply:function(a){u.reply(a,"reply")},atMember:function(a){var b=!1;b=$CONFIG.$tip=="1"?!0:!1;if(b&&scope.$isLogin())window.open("http://service.weibo.com/signup/full_info.php?appsrc=1JreRx&showlogo=0&backurl="+encodeURIComponent(document.URL)+"&nonick=1&lang=zh-cn&callback=http%3A%2F%2Fweibo.com&vsrc=weibolist","login","width=580,height=280");else{var c="";for(var d=0;d<i.length;d++)if(i[d].test(location.href)){c=j[d];break}window.listclose=function(){};c+="&tag=@"+a.data.name;c+="&content=在微集体 【"+a.data.listname+"】中，对@"+a.data.name+" 说：";c+="&app_src="+$CONFIG.$appsrc;c+="&vsrc="+a.data.vsrc;c+="&ext="+a.data.ext;window.open(c,"publish","width=580,height=280")}}},W=function(){scope.$feedInfo={};$CONFIG.$sidebar=="1"?K=!0:K=!1;if(l.feed_container){A={contentOuter:G,contentInner:H,dragOuter:scrollContainer,dragInner:scrollBar};u=a.comp.widget.list.publish(l.feed_container,l.main_container);w=a.comp.widget.list.feed(l.feed_container,A)}a.comp.widget.list.styleDiy(l,g);if(!!I){var b=I.getElementsByTagName("ul")[0];if(b){L=b.getElementsByTagName("li")[0];L&&a.core.dom.addClassName(L,"select_current")}Q.init(K)}},X=function(){H.innerHTML=y;w.rebuildScroll();Q.init(K)},Y=function(){y=H.innerHTML;w.destroy();x.destroy()};R();k.reset=X;k.content=y;k.destroy=Y;return k}});
STK.register("common.widget.page",function(a){var b={},c=a.core.evt.addEvent,d;return function(c,e,f){var g={totalPage:0,styleName:{current:"",normal:"",ellipsis:"",lastPage:"",nextPage:""},pagePick:null};g=a.parseParam(g,c);var h,i,j=[],k=function(a){p.initHTML(--i)},l=function(a){p.initHTML(++i)},m=function(a){i=a;p.initHTML(a)},n=function(a){var b=a.data.index;if(b==0)k();else if(b==-2)l();else{if(b==-1)return;b--;m(b)}g.pagePick(i)},o=function(a,b){var c=document.createElement("a");c.className=g.styleName.normal;c.innerHTML=a.index;c.setAttribute("action-type","pageItem");c.setAttribute("action-data","index="+a.index);a.index-1==i&&(c.className=g.styleName.current);if(a.index==0){c.innerHTML="";c.className=g.styleName.lastPage}else if(a.index==-1){c.innerHTML="…";c.className=g.styleName.elapsis}else if(a.index==-2){c.innerHTML="";c.className=g.styleName.nextPage}return c},p={initHTML:function(a){h.innerHTML="";i=a;if(a>=j.length)throw"index out of range";a==0?q.firstMode(a):a<4?q.headMode(a):a>=j.length-4?q.footMode(a):q.middleMode(a)},getDOM:function(){return h}},q={firstMode:function(a){var b=[];for(var c=0;c<4&&c<j.length;c++)b[b.length]=o(j[c],a);j.length>5&&(b[b.length]=o({index:-1},a));j.length>4&&(b[b.length]=o(j[j.length-1],a));a!=j.length-1&&(b[b.length]=o({index:-2},a));for(var c=0;c<b.length;c++)h.appendChild(b[c])},headMode:function(a){var b=[],c=0;b[b.length]=o({index:0},a);for(var d=0;d<j.length&&c<4;d++){b[b.length]=o(j[d],a);c++}j.length>5&&(b[b.length]=o({index:-1},a));j.length>4&&(b[b.length]=o(j[j.length-1],a));a!=j.length-1&&(b[b.length]=o({index:-2},a));for(var d=0;d<b.length;d++)h.appendChild(b[d])},footMode:function(a){var b=[],c=0;b[b.length]=o({index:0},a);b[b.length]=o(j[0],a);j.length>5&&(b[b.length]=o({index:-1},a));for(var d=j.length-4;d<j.length;d++)b[b.length]=o(j[d],a);a!=j.length-1&&(b[b.length]=o({index:-2},a));for(var d=0;d<b.length;d++)h.appendChild(b[d])},middleMode:function(a){var b=[],c=0;b[b.length]=o({index:0},a);b[b.length]=o(j[0],a);b[b.length]=o({index:-1},a);for(var d=a-1;d<j.length&&c<3;d++){b[b.length]=o(j[d],a);c++}b[b.length]=o({index:-1},a);b[b.length]=o(j[j.length-1],a);b[b.length]=o({index:-2},a);for(var d=0;d<b.length;d++)h.appendChild(b[d])}},r=function(){if(f==null)throw"node is not defined"},s=function(){},t=function(){},u=function(){d=a.core.evt.delegatedEvent(f);d.add("pageItem","click",n)},v=function(){h=document.createElement("span");for(var a=0;a<g.totalPage;a++)j[a]={index:a+1};p.initHTML(e)},w=function(){r();s();t();v();u()};w();b=p;return b}});
STK.register("comp.widget.list.member",function(a){var b=a.kit.extra.language,c,d="http://widget.weibo.com/public/publishmblog.php?ac=add_mblog&appkey=757169608&app_src=1du58Q&";return function(d){var e={},f,g,h,i,j=a.common.trans.list,k,l,m,n=[],o,p,q=1,r,s,t,u='<div class="WB_pages_minibtn" node-type="page_container"></div>',v='<div class="loading_inform"><u class="WB_ico_loadingD"></u>加载信息</div>',w={init:function(c){h.style.marginTop="0px";h.innerHTML=v;var d=j.getTrans("getmember",{onComplete:function(b,c){h.innerHTML=b.data;var d=a.kit.dom.parseDOM(a.builder(h).list);p=d.member_list;m=d.current_page;s=d.page_prev;t=d.page_next;m&&(m.innerHTML=q+" / "+r);s&&(q==1?s.style.display="none":s.style.display="");t&&(q==r?t.style.display="none":t.style.display="");i=a.common.widget.dragScroll({contentOuter:f.main_container,contentInner:f.feed_container,dragOuter:f.scroll_container,dragInner:f.scroll_bar});k=h.innerHTML},onFail:function(){h.innerHTML=b("#L{请求失败，请稍候再试}")}});d.request({app_src:scope.$appsrc,listid:scope.$listid,uid:scope.$oid,cursor:c,language:scope.$language,refer:encodeURIComponent(document.referrer)})},reset:function(){h.style.marginTop="0px";h.innerHTML=k;g.style.lineHeight=f.header_container.offsetHeight-13+"px";var b=a.kit.dom.parseDOM(a.builder(d).list);b.content_switch.style.lineHeight=f.header_container.offsetHeight-13+"px";b.content_switch.style.display="";i=a.common.widget.dragScroll({contentOuter:f.main_container,contentInner:f.feed_container,dragOuter:f.scroll_container,dragInner:f.scroll_bar});k=h.innerHTML},pagePick:function(a){w.init(a)},atMember:function(a){var b="http://widget.weibo.com/public/publishmblog.php?ac=add_mblog";b+="&tag=@"+a.data.name;b+="&content=对@"+a.data.name+" 说：";b+="&app_src="+$CONFIG.$appkey;window.open(b,height=300)},itemHover:function(b){var c=a.kit.dom.parseDOM(a.builder(b.el).list),d=c.at;d.style.display=""},itemMouseOut:function(b){var c=a.kit.dom.parseDOM(a.builder(b.el).list),d=c.at;d.style.display="none"}},x={init:function(c){var d=a.kit.dom.parseDOM(a.builder(b(u)).list).page_container,e={totalPage:parseInt($CONFIG.$pagecount,10),styleName:{current:"pages_item S_bg_hover current",normal:"pages_item S_bg_hover",ellipsis:"doccolor",lastPage:"reverse",nextPage:"next"},pagePick:x.pageChecked};l=a.common.widget.page(e,c,d);o=c;d.appendChild(l.getDOM());h.appendChild(d)},pageChecked:function(a){if(o!=a){i!=null&&i.destroy();w.pagePick(a)}},turnPage:function(a){var b=a.data.cursor||0,c=a.data.type;if(!(c=="next"&&q==r||c=="prev"&&q==1)){c=="next"?q++:c=="prev"&&q--;i!=null&&i.destroy();h.style.marginTop="0px";x.getMembers(b)}},getMembers:function(c){c=c||0;l=c;var d=j.getTrans("getmember",{onComplete:function(b,c){if(b.code=="A00006"){h.innerHTML=b.data;i=a.common.widget.dragScroll({contentOuter:f.main_container,contentInner:f.feed_container,dragOuter:f.scroll_container,dragInner:f.scroll_bar});var d=a.kit.dom.parseDOM(a.builder(h).list);m=d.current_page;m.innerHTML=q+" / "+r;k=h.innerHTML;s=d.page_prev;t=d.page_next;q==1?s.style.display="none":s.style.display="";q==r?t.style.display="none":t.style.display=""}},onFail:function(){h.innerHTML=b("#L{请求失败，请稍候再试}")}});d.request({appkey:scope.$appkey,listid:scope.$listid,uid:scope.$oid,cursor:c||0,language:scope.$language})}},y=function(){i!=null&&i.destroy()},z=function(){k!=null&&w.reset()},A=function(){if(d==null)throw"node is not defined"},B=function(){f=a.kit.dom.parseDOM(a.builder(d).list);h=f.feed_container;g=f.content_switch},C=function(){c=a.core.evt.delegatedEvent(d);c.add("page","click",x.turnPage);c.add("member_item","mouseover",w.itemHover);c.add("member_item","mouseout",w.itemMouseOut)},D=function(){r=$CONFIG.$pagecount;g.style.lineHeight=f.header_container.offsetHeight-13+"px";g.style.display="";w.init(0)},E=function(){A();B();C();D()};E();e.reset=z;e.destroy=y;return e}});
STK.register("common.login.isOpent",function(a){var b=[/^http:\/\/widget.weibo.com/,/^http:\/\/service.t.sina.com.cn/,/^http:\/\/service.weibo.com/],c=["http://widget.weibo.com/public/aj_isopent.php","http://service.t.sina.com.cn/widget/public/aj_isopent.php","http://service.weibo.com/widget/public/aj_isopent.php"];return function(d){var e={onComplete:function(){},onFail:function(){}};e=a.parseParam(e,d);var f=location.href,g="";for(var h=0;h<b.length;h++)if(b[h].test(f)){g=c[h];break}a.ajax({url:g,onComplete:e.onComplete,onFail:e.onFail})}});
STK.register("comp.widget.list.list",function(a){var b,c=a.core.util.listener;return function(d,e){var f,g,h,i,j,k,l,m=a.common.login.getLoginStatus,n=a.template.widget.list(),o='<a class="return_link" href="#0" title="" style="display:none;" action-type="content_switch" node-type="content_switch" action-data="type=member">«返回</a>',p=function(b){if(b.data.type=="feed"){i=h.innerHTML;f.aside_part.style.display="none";f.aside_switch.style.display="none";g.destroy();h.innerHTML=o;j==null?setTimeout(function(){j=a.comp.widget.list.member(d)},20):j.reset()}else{h.innerHTML=i;g!=null&&g.reset();j.destroy()}},q={init:function(){q.initHeight();q.initLoginStatus()},initHeight:function(){var a=parseInt($CONFIG.$height),b=0,c=0;l&&(b=l.offsetHeight);k&&(c=k.offsetHeight);var d;h?d=a-b-c-h.offsetHeight-4:d=a-b-c-4;f.main_container.style.height=d+"px"},initLoginStatus:function(){var b=location.href,c=!1,d=/(\S{5})$/;d.test(b)&&RegExp.$1==="dpc=1"&&(c=!0);if(c)if(m.isLogin())a.common.login.isOpent({onComplete:function(b){var c={},d;c.nick=b.nick;c.uid=scope.$uid;c.listname=scope.$listname;c.backurl=encodeURIComponent(location.href);d=a.core.util.easyTemplate(n.loginedTitleTemplate,c);l&&(l.innerHTML=d)}});else if(l){var e={};e.listname=scope.$listname;var f=a.core.util.easyTemplate(n.unLoginTitleTemplate,e);l.innerHTML=f}},login:function(b){a.common.login.isOpent({onComplete:function(b){var c={},d;c.nick=b.nick;c.uid=scope.$uid;c.listname=scope.$listname;c.backurl=encodeURIComponent(location.href);d=a.core.util.easyTemplate(n.loginedTitleTemplate,c);l&&(l.innerHTML=d)}})}},r=function(){if(d==null)throw"node is not defined"},s=function(){f=a.kit.dom.parseDOM(a.builder(d).list);feedContainer=f.feed_container;h=f.header_container;k=f.bottom_bar;l=f.title_bar},t=function(){c.register("login","login",q.login)},u=function(){b=a.core.evt.delegatedEvent(d);b.add("content_switch","click",p)},v=function(){var a=new Image,b="http://rs.sinajs.cn/tmp.gif?";b+="id=list&action=pv";b+="&uid="+$CONFIG.$uid;b+="&cuid="+$CONFIG.$oid;b+="&listid="+$CONFIG.$listid;b+="&refer="+encodeURIComponent(document.referrer);b+="&appkey="+scope.$appkey;b+="&r="+(new Date).valueOf();a.src=b},w=function(){h&&(h.style.height=h.offsetHeight-13+"px");setTimeout(function(){g=a.comp.widget.list.feedList(d,e)},200);v()},x=function(){r();s();t();u();q.init();w()};x()}});
STK.pageletM.register("pl.widget.list",function(a){try{var b={},c=a.E("pl_widget_list"),d=a.comp.widget.list.list(c,b);return d}catch(e){}});
STK.pageletM.start();
